%!TEX root=../main.tex
\chapter{Simulation Results} \label{chap:simulation}
\minitoc

In this chapter the numerical discrete dynamic gradient damage model summarized in \cref{algo:implicit,algo:explicit} is applied to investigate numerous academic or real-world fracture problems. Since this part constitutes an essential part of the present work, the organization of these simulation results is described as follows:
\begin{itemize}
\item \textbf{Ordering}: the fracture problems considered in this chapter are ordered in terms of \emph{computational complexity}. The FEniCS implementation is used first to analyze some academic problems under the small displacement hypothesis: the crack nucleation problem in a one-dimensional bar (\cref{sec:1d}), the 2-d scalar antiplane tearing problem (\cref{sec:antiplane}) and the 2-d plane crack kinking problem (\cref{sec:kinking}). Afterwards, real-world dynamic fracture problems are considered in the EPX software environment: the 2-d plane crack branching problem (\cref{sec:branching}), the Kalthoff experiment (\cref{sec:kalthoff}) and the crack arrest problem (\cref{sec:gregoire}). Application to concrete structures are considered at the end: the Brazilian test on concrete cylinders (\cref{sec:brazilian}), the dynamic fracture problem of a L-shaped concrete specimen (\cref{sec:L-specimen}) and the CEA impact test on beams (\cref{sec:beam}). If one focuses on different phases of crack evolution, the following diagram can be obtained. \cref{sec:brazilian,sec:L-specimen,sec:beam} constitute an application of the dynamic gradient damage model to real concrete structures and are not listed in the diagram.
\begin{center}
\begin{tabular}{ccccccc}
Nucleation &$\to$& Propagation &$\to$& Kinking \& Branching &$\to$& Arrest \\
\cref{sec:1d} && \cref{sec:antiplane} && \cref{sec:kinking,sec:branching,sec:kalthoff} && \cref{sec:gregoire}
\end{tabular}
\end{center}

\item \textbf{Objectives}: using the classification given in \cref{sec:scope}, the scope of these simulations is to carry out an investigation of several damage constitutive laws and tension-compression asymmetry formulations (link with phase-field approaches represented by $\alpha\leftrightarrow\phi$), to provide a better understanding of gradient-damage modeling of fracture $\nabla\alpha\to\Gamma$) and to compare the simulation results with the experimental data (simulation validation). The precise objectives and the thematic subjects covered will be as usual recalled at the beginning of each section.
\end{itemize}

Contrary to previous chapters, a conclusion is provided at the end of each numerical simulation. According to the definition of the thematic subjects given in \cref{sec:scope}, these numerical simulations can be classified in \cref{tab:summsim}.
\begin{table}[htbp]
\centering
\caption{Thematic subjects covered in the numerical simulations of this chapter} \label{tab:summsim}
\begin{tabular}{cccc} \toprule
& $\alpha\leftrightarrow\phi$ & $\nabla\alpha\to\Gamma$ & Experimental validation \\ \midrule
Numerics & \cref{sec:branching,sec:kalthoff,sec:brazilian} & \cref{sec:1d,sec:antiplane,sec:kinking,sec:branching,sec:kalthoff,sec:brazilian,sec:L-specimen} & \cref{sec:branching,sec:kalthoff,sec:gregoire,sec:brazilian,sec:L-specimen,sec:beam} \\ \bottomrule
\end{tabular}
\end{table}

\section{Crack Nucleation in a Bar Under Impact} \label{sec:1d}
This section is devoted to a numerical analysis of a one-dimensional bar under impact loading conditions. The focus is on crack nucleation in dynamics using the gradient damage model. In the absence of an initial crack in the problem setting, the classical Griffith's theory of fracture is incapable of predicting material and structural failure. Hence here the simulation results will be compared to local strain-softening models (conventional damage models for instance). The objective is to illustrate the crack nucleation criterion in gradient damage models and the role played by the internal length in such process. The thematic subjects covered here are thus summarized in \cref{tab:summbar}.
\begin{table}[htbp]
\centering
\caption{Thematic subjects covered in this section} \label{tab:summbar}
\begin{tabular}{ccccc} \toprule
& Going dynamical & $\alpha\leftrightarrow\phi$ & $\nabla\alpha\to\Gamma$ & Experimental validation \\ \midrule
Theoretics & & & & \\
Numerics & & & \rightthumbsup & \\ \bottomrule
\end{tabular}
\end{table}

\subsection{Analytical solutions for local strain-softening materials}
This problem is initially considered by \cite{Bazant:1985aa} for an elastic strain-softening material. The one-dimensional initially stationary bar occupying the interval $[-L,L]$ is subject at both ends to a tensile shock $\vec{U}_t=\pm vt\,\vec{e}_1$ where $v$ measures the intensity, see \cref{fig:elassoftening}. Due to the jump condition, the strain waves propagate with an initial value of $\varepsilon=v/c$ at the wave speed $c=\sqrt{E/\rho}$. At $t=\frac{L}{c}$ when the two waves meet at the center, the strain at $x=0$ is doubled $\varepsilon=2v/c$ and continues to propagate to the rest part of the bar. We will only focus on the dynamic evolution in the time interval $[0,\frac{2L}{c}]$ before the waves travel the whole length. In \cite{Bazant:1985aa}, the material strain-softening condition is satisfied at a given critical strain level $\varepsilon_\mc$. If this criterion is never met, the analytical solution corresponds to a purely elastodynamic problem, which is given by
\begin{align*}
u &= -v\inp{t-\frac{x+L}{c}}+v\inp{t+\frac{x-L}{c}}\,, \\
\varepsilon &= \frac{v}{c}\mH\left(t-\frac{x+L}{c}\right)+\frac{v}{c}\mH\left(t+\frac{x-L}{c}\right)\,,
\end{align*}
where $\inp{x}=(\abs{x}+x)/2$ and $\mH$ denotes the Heaviside step function. The strain field evolution is illustrated in \cref{fig:elassoftening}(a). 
\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{elassoftening.pdf}
\caption{Strain field before and after the wave crossing at $t=\frac{L}{c}$ for (a) the elastodynamic model (or if the strain-softening criterion $\varepsilon_\mc$ is never met) and (b) the local strain-softening model if $\varepsilon_\mc$ is met at $t=\frac{L}{c}$} \label{fig:elassoftening}
\end{figure}
Otherwise, two cases could be separately discussed concerning the intensity of the impact velocity $v$ and the strain-softening criterion $\varepsilon_\mc$:
\begin{enumerate}
\item If $v$ is sufficiently high such that at $t=0$ the strain-softening criterion is met, \emph{i.e.} $\frac{v}{c}>\varepsilon_\mc$, then fracture takes place immediately at $t=0$ when the impact is applied. The impacted ends $x=\pm L$ are broken and the rest part of the bar remains stationary.

\item If the strain-softening criterion $\varepsilon_\mc$ is satisfied when the two tensile waves arrive at the center at $t=\frac{L}{c}$, \emph{i.e.} $\frac{2v}{c}>\varepsilon_\mc$ but $\frac{v}{c}<\varepsilon_\mc$, then according to \cite{Bazant:1985aa}, the analytical solution becomes
\begin{equation} \label{eq:elaslocal}
\begin{aligned}
u &= -v\inp{t-\frac{x+L}{c}}-v\inp{t-\frac{L-x}{c}}\,, \\
\varepsilon &= \frac{v}{c}\mH\left(t-\frac{x+L}{c}\right)-\frac{v}{c}\mH\left(t-\frac{L-x}{c}\right)+4v\inp{t-\frac{L}{c}}\delta_0\,,
\end{aligned}
\end{equation}
which is applicable for $x\leq 0$. For $x>0$ a symmetric solution applies. The strain field before and after the wave-crossing is illustrated in \cref{fig:elassoftening}(b). At $t=\frac{L}{c}$ the bar breaks instantaneously at the center. For $t\geq\frac{L}{c}$, the displacement develops at the center a discontinuity of magnitude $4v\inp{t-\frac{L}{c}}$. Hence a Dirac distribution is present in the strain field expression.
\end{enumerate}

Several remarks can be given concerning the physical deficiencies of local strain-softening models in this particular dynamic problem:
\begin{itemize}
\item The ultimate fracture takes place instantaneously when the strain-softening criterion is satisfied. The structural failure mechanism is size-independent.

\item Fracture takes place instantaneously with a vanishing energy dissipation, consequently spurious mesh dependency is observed for finite element solutions, see our discussions on this point in \cref{sec:twointerpretations}. It can be observed that \eqref{eq:elaslocal} corresponds to the elastodynamic solution of the bar initially broken at $x=0$, which implies total mechanical energy conservation and no additional energy dissipation when fracture happens at $t=\frac{L}{c}$.
\end{itemize}

As we shall see in the sequel, the gradient-damage approach of fracture permits a better modeling of crack nucleation, via the introduction of a length scale.

\subsection{Gradient-damage modeling}
The dynamic gradient damage model outlined in \cref{def:dynagraddama} is applied for this particular one-dimensional problem. Symmetry is taken into account and only the interval $\Omega=[0,L]$ is modeled. The displacement at $x=0$ is blocked due to symmetry. The explicit time-stepping described by \cref{algo:explicit} is used in the FEniCS implementation, see \cite{LiMaurini:2015}.

The Lagrangian involved in the generalized space-time action integral \eqref{eq:actionG} reads
\[
\mathcal{L}(u_t,\dot{u}_t,\alpha_t)=\int_\Omega\left(\frac{1}{2}\mathsf{a}(\alpha_t)Eu_t'^2+w(\alpha_t)+w_1\eta^2\alpha_t'^2-\frac{1}{2}\rho\dot{u}_t^2\right)\D{x}.
\]
A rescaling of the displacement by $u_\mc$ and a normalization of the space/time scales is performed to obtain a non-dimensional problem. Specifically, displacement is scaled by a factor of $u_\mc=\sigma_\mc L/E$ where $\sigma_\mc$ corresponds to the critical stress of the gradient damage material, see \eqref{eq:sigc0}, and $u_\mc$ is thus the critical displacement at the end $x=L$ of a bar fixed at $x=0$ in the quasi-static condition. The half-bar length $L$ and the corresponding time $L/c$ for the elastic wave to travel such distance is used to normalize the spatial and temporal scales. We have thus
\begin{align}
u(x,t) &= u_\mc\,\uhat\left(\frac{x}{L},\frac{ct}{L}\right)=u_\mc\,\uhat(y,\tau)\,, \label{eq:uhat} \\
\alpha(x) &= \ahat\left(\frac{x}{L}\right)=\ahat(y)\,, \notag
\end{align}
where $y$ and $\tau$ designate respectively the normalized space and time coordinates.

In this work the damage constitutive law \eqref{eq:at1} is used. According to \cref{sec:ingredients}, the critical stress is then given by $\sigma_\mc=\sqrt{w_1E}$, which leads to the following non-dimensional Lagrangian
\begin{equation} \label{eq:nondimensionalL}
\widehat{\mathcal{L}}(\uhat_\tau,\dot{\uhat}_\tau,\ahat_\tau)=w_1L\int_0^1\left(\frac{1}{2}(1-\ahat_\tau)^2\uhat_\tau'^2+\ahat_\tau+\widehat{\eta}^2\ahat_\tau'^2-\frac{1}{2}\dot{\uhat}_\tau^2\right)\D{y}.
\end{equation}
For a given finite $\eta$, the length scale $\widehat{\eta}=\eta/L$ is the only non-dimensional parameter influencing the qualitative behaviors of the problem. Numerically, this amounts to solve the evolution problem in the normalized interval $[0,1]$ with the parameters indicated in \cref{tab:para1d}. The relationship \eqref{eq:gcingd} between $w_1$ and $\gc$ is also used.
\begin{table}[htbp]
\centering
\caption{Geometric and material parameters for the crack nucleation problem} \label{tab:para1d}
\begin{tabular}{lllll} \toprule
$L$ & $\rho$ & $E$ & $\gc$ & $\sigma_\mc$ \\ \midrule
1 & 1 & 1 & $\frac{8}{3}\eta$ & 1 \\ \bottomrule
\end{tabular}
\end{table}

Using the normalized space and time scales, we assume that at $y=1$ the bar is subject to the impact condition $\widehat{\vec{U}}_\tau=\widehat{v}\tau\,\vec{e}_1$. The time interval of interest is $\tau\in[0,2]$. Using the definition of the critical stress \eqref{eq:sigc0}, after normalization, the damage initiation criterion \eqref{eq:damageinitiationsound} for an initially sound body (with $\widehat{\alpha}_\tau=0$ almost everywhere) reads hence
\begin{equation} \label{eq:nuclecrit}
\uhat_\tau'^2=1.
\end{equation}
This implies that damage could takes place wherever \eqref{eq:nuclecrit} is satisfied. Tension-compression asymmetry \eqref{eq:elasticTC} is not considered here. Using the jump condition, we have thus
\begin{itemize}
\item If $\widehat{v}>1$, then the damage criterion is instantaneously met at $y=1$ and subsequent crack nucleation could take place soon.
\item If $0.5<\widehat{v}<1$, then the damage criterion is satisfied at $\tau=1$ when the two waves arrive at the center. A typical strain and damage evolution obtained with the dynamic gradient damage model is indicated in \cref{fig:grad3d}. Strain localization takes place and damage evolves at the center, which resembles the result obtained with the local strain-softening model in \cref{fig:elassoftening}.
\end{itemize}
\begin{figure}[htbp]
\centering
\includegraphics[width=0.95\textwidth]{grad3d.pdf}
\caption{Strain (a) and damage (b) before and after the wave crossing at $t=\frac{L}{c}$ in the dynamic gradient damage model with $\widehat{\eta}=0.01$} \label{fig:grad3d}
\end{figure}

\subsection{Numerical convergence properties}
We first analyze the numerical convergence properties of dynamic gradient damage models given a fixed length ratio $\eta/L$. With a uniform linear finite element interpolation with typical mesh size $h$ and the explicit Newmark scheme (along with mass lumping) with a time increment corresponding to the CFL time step $\Delta \tau=\Delta \tau_\mathrm{CFL}=h$ (since the wave speed is normalized to 1), it is known that the displacement $u_h$ at time $\tau\in[0,2]$ for an elastodynamic problem (without damage or strain-softening) converges with order $\mathcal{O}(h^2)$ in the $L^2$ norm for the error defined by
\begin{equation} \label{eq:error}
e_h=\frac{\norm{u_h-u_\mathrm{ref}}_{L_2}}{\norm{u_\mathrm{ref}}_{L_2}}=\frac{\sqrt{\int_\Omega(u_h-u_\mathrm{ref})^2\D{x}}}{\sqrt{\int_\Omega u_\mathrm{ref}^2\D{x}}}.
\end{equation}
Furthermore, superconvergence can be observed for this particular one-dimensional problem with the above numerical parameters, see \cite{Hughes:1987}. In this case the obtained results are exact (with respect to the original time-space continuous problem) at discretization nodes independently of how few elements are used. The convergence rate as well as this property can be illustrated numerically by considering an elastic bar subject to $\widehat{\vec{U}}_\tau=\frac{1}{2}(1-\cos(\pi \tau))\,\vec{e}_1$ at $y=1$. A snapshot of the dynamic system state at $\tau=1$ is taken. In \eqref{eq:error}, $u_\mathrm{ref}$ is taken to be a reference solution obtained with $h=\num{1e-3}$. From \cref{fig:elasconv}, the quadratic convergence as well as the superconvergence property is verified. If a velocity shock is applied here, since the analytical solution is piecewise linear, the finite element solution would coincide exactly with the theoretic one.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.95\textwidth]{elas_h.pdf}
\caption{Numerical convergence for the elastodynamic problem} \label{fig:elasconv}
\end{figure}

In the dynamic gradient damage model, numerical convergence is studied for the displacement and the damage at $\tau=2$, with an impact speed $\widehat{v}=0.6$ and two length scales $\widehat{\eta}=0.1$ or $0.2$. The results are indicated in \cref{fig:gradhell0x1,fig:gradhell0x2}. The reference solution is obtained with $h=\widehat{\eta}/100$.
\begin{figure}[htbp]
\includegraphics[width=0.95\textwidth]{grad_h_ell0x1.pdf}
\caption{Numerical convergence study for $\widehat{\eta}=0.1$: (a) displacement at $\tau=2$ and (b) convergence rates} \label{fig:gradhell0x1}
\end{figure}
\begin{figure}[htbp]
\includegraphics[width=0.95\textwidth]{grad_h_ell0x2.pdf}
\caption{Numerical convergence study for $\widehat{\eta}=0.2$: (a) displacement at $\tau=2$ and (b) convergence rates} \label{fig:gradhell0x2}
\end{figure}
Several remarks are given as follows.
\begin{itemize}
\item The superconvergence property is lost, since it can be observed that solutions with different discretization sizes no longer agree with each other exactly at the nodes.
\item The quadratic convergence rate for the displacement and the damage may degenerate according to the value of the length scale $\widehat{\eta}$. As $\widehat{\eta}\to 0$ (see \cref{fig:gradhell0x1}), strain is more localized near $y=0$, which may lead to a lower convergence rate. In any case, convergence is ensured. We assume that $h=\widehat{\eta}/10$ gives sufficiently accurate results and hence will be used in all subsequent calculations.
\end{itemize}

\subsection{Energy dissipation at fracture}
Consider the case when the damage criterion \eqref{eq:nuclecrit} will be first satisfied at $\tau=1$ when the two tensile waves encounter at the center. Fracture in gradient damage models is defined as the event when/where $\widehat{\alpha}_t(y)\approx 1$ somewhere in the bar. Numerically the value of 0.99 is used as the threshold. For the shock velocity $\widehat{v}=0.6$ and the length scale $\widehat{\eta}=0.1$, the final damage field at fracture is illustrated in \cref{fig:alphatf}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\linewidth]{alpha.pdf}
\caption{Damage field at fracture with $\widehat{v}=0.6$ and $\widehat{\eta}=0.1$} \label{fig:alphatf}
\end{figure}
The analytical quasi-static optimal damage field \eqref{eq:at1alpha} is also indicated. Recall that the optimal damage field \eqref{eq:defoptimaldamage} corresponds to the equivalent fracture toughness \eqref{eq:gcingd}. Since here the damage band obtained is wider than the optimal one, more energy is dissipated than the $\gc$ defined via \eqref{eq:gcingd}.

This overdissipation is analyzed for different length scales and shock velocities, see \cref{fig:Gc-ell}. The energy dissipated at fracture is normalized by the quasi-static fracture toughness defined via \eqref{eq:gcingd}. We observe that the overdissipation of approximately 30\% seems to be independent of the length ratio $\eta/L$ and shows little dependence on the shock velocity. In any case, with a gradient damage modeling of fracture, fracture takes place always with a non-vanishing energy dissipation. Future work will be devoted to a better understanding of this over-dissipation.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\linewidth]{Gc-ell.pdf}
\caption{Dissipated energy when the bar breaks} \label{fig:Gc-ell}
\end{figure}

\subsection{Size effect}
Recall that in local strain-softening models the instant of fracture coincides with the instant when the strain-softening mechanism is satisfied. This implies that the structural failure is size-independent. Consider first the case when fracture takes place at $\tau=1$ in local models, \emph{i.e.} for $\widehat{v}\in(0.5,1)$. The instant of fracture $\tau_\mathrm{f}$ for different length scales $\eta/L$ is illustrated in \cref{fig:tfell}, where the result $\tau_\mathrm{f}=1$ for local models is also indicated.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\linewidth]{tf-ell.pdf}
\caption{Size effect illustrated by the instant of fracture for different length scales for $\widehat{v}\in(0.5,1)$} \label{fig:tfell}
\end{figure}
Several remarks are given as follows.
\begin{itemize}
\item With dynamic gradient damage models, the instant of fracture normalized by the factor $\frac{L}{c}$ depends on the length scale $\eta/L$, which illustrates a size effect. In local strain-softening models fracture takes place always at $t=\frac{L}{c}$, or $\tau=1$.

\item At fixed internal length $\eta$ (material property), shorter bars delay ultimate fracture (\emph{smaller is stronger}), while for longer bars the fracture behavior is similar to that predicted by the local model. Comparison between these two models can be analyzed in the limit $\eta/L\to 0$. It will be performed in the next section.

\item Contrary to quasi-static situations, this size effect depends also on the shock velocity. For higher velocities $\widehat{v}\approx 1^-$, the fracture instant approaches that of the local strain-softening model. The reverse is observed for lower shock speeds for $\widehat{v}\approx 0.5^+$.
\end{itemize}

For higher shock speeds $\widehat{v}>1$, fracture will take place immediately at $\tau=0$ for local models independently of the size of the bar. For gradient damage models, another size effect diagram is observed, see \cref{fig:sizeeffectv1}(a). In can be seen that longer bars behave exactly like the local strain-softening models, \emph{i.e.} $\tau_\mathrm{f}\to 0$. Again, fracture can be delayed for shorter bars. For small length ratios $\eta/L$, the instant of fracture $\tau_\mathrm{f}$ scales linearly with $\eta/L$. With $\eta/L=0.01$, the dependence of the instant of fracture on the shock velocity is analyzed in \cref{fig:sizeeffectv1}(b). According to these two diagrams in \cref{fig:sizeeffectv1}, we have the following estimation for small length scales $\eta/L\ll 1$ and large shock velocities $\widehat{v}\gg 1$
\[
\tau_\mathrm{f}\propto\widehat{\eta}\cdot\widehat{v}^{\,-1.75}.
\]
\begin{figure}[htbp]
\centering
\includegraphics[width=\linewidth]{tf-ell2v.pdf}
\caption{(a) Size effect illustrated by the instant of fracture for different length scales $\widehat{v}>1$. (b) Dependence of the instant of fracture on the shock velocity with $\eta/L=0.01$} \label{fig:sizeeffectv1}
\end{figure}

Using the definition of the rescaled time $\tau$, the linear scaling of the rescaled instant of fracture with respect to the length scale $\tau_\mathrm{f}\propto\widehat{\eta}$ leads to
\begin{equation} \label{eq:tfc}
t_\mathrm{f}\propto\frac{\eta}{c}.
\end{equation}
It can be seen that here the value of the internal length determines the actual structural failure instant and should be considered as a material parameter. Future work will be devoted to a theoretic understanding of \eqref{eq:tfc}.

\subsection{Link with local strain-softening models}
As indicated by \cref{fig:tfell,fig:sizeeffectv1}, the fracture behaviors of longer bars are similar to that predicted by the local strain-softening model. At $\tau=0.6$, the asymptotic behavior of the rescaled displacement when $\eta/L\to 0$ is indicated in \cref{fig:comp1d} for two shock velocities. The solution due to the local strain-softening model is also indicated.
\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{comp_1d.pdf}
\caption{Asymptotic behavior of the rescaled displacement when $\eta/L\to 0$ compared with the local strain-softening model: (a) $\widehat{v}=0.6$ and (b) $\widehat{v}=0.9$} \label{fig:comp1d}
\end{figure}

A slow convergence can be observed in the $L^2$-norm of the normalized displacement, see \cref{fig:conv_ell}. The convergence rate shows dependence on the shock velocity. In the limit $\ell/L\to 0$, the normalized displacement $\widehat{u}$ thus converges to that predicted by the local strain-softening model.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\linewidth]{conv_ell.pdf}
\caption{Convergence rate for the rescaled displacement when $\eta/L\to 0$} \label{fig:conv_ell}
\end{figure}

However note that this convergence toward the local strain-softening model can never be attained and should only be considered as a limiting behavior of dynamic gradient damage models, see also the discussion between the variational approach to fracture and gradient damage approaches in \cref{sec:twointerpretations}. Several remarks are given as follows.
\begin{itemize}
\item The above convergence is established for the normalized displacement. Using the definition \eqref{eq:uhat}, for $\widehat{v}\in(0.5,1)$ the real displacement tends to develop a sharp discontinuity at $x=0$ with a jump of magnitude
\[
\llbracket u_t(0)\rrbracket=4vu_\mc\inp{t-\frac{L}{c}}=4v\sqrt{\frac{3\gc}{8E\eta}}L\inp{t-\frac{L}{c}}.
\]

\item For very long bars $L\to\infty$, the two tensile waves can never arrive at the center and for $\widehat{v}\in(0.5,1)$ fracture will never take place, since $\llbracket u_t(0)\rrbracket\to 0$ when $L\to \infty$.

\item Very small internal lengths $\ell\to 0$ imply an infinite critical stress $\sigma_\mc\to\infty$ through \eqref{eq:sigc0}, hence again fracture can never take place. Instead $\ell$ should be considered as a material parameter, see \cref{sec:twointerpretations}.
\end{itemize}

\subsection*{Conclusion}
As is demonstrated by numerical simulations, a gradient-damage approach of dynamic fracture leads to a better modeling of crack nucleation in the following aspects:
\begin{itemize}
\item In the Griffith's theory crack nucleation is not possible for an initially sound body. In the gradient damage model (with a fixed internal length $\ell$), crack can nucleate and the damage initiation criterion is given by \eqref{eq:nuclecrit}.

\item The internal length $\ell$ influences numerical convergence properties and needs further investigation concerning in particular the convergence rates.

\item In gradient damage models, fracture takes place with a finite non-vanishing energy dissipation while in local strain-softening models it is not the case. In dynamics a systematic over-dissipation is observed for all internal lengths and needs further investigation.

\item In local strain-softening models the fracture mechanism is size-independent. In gradient damage models the length ratio $\ell/L$ achieves a size effect in terms of the fracture instant. The general belief \emph{smaller is stronger} is verified.

\item A certain link between gradient damage models and local strain-softening models is found by investigating the limit $\ell/L\to 0$. In such process, the fracture behavior of gradient damage models is qualitatively similar to that of local models, if the normalized displacement \eqref{eq:uhat} is considered.
\end{itemize}

\section{Antiplane Tearing} \label{sec:antiplane}
In \cref{sec:1d} the crack \emph{nucleation} is considered and a stress-based criterion \eqref{eq:damageinitiationsound2} governs the damage initiation. This section discusses a particular numerical experiment tailored to highlight the properties of the dynamic gradient damage model while focusing on the \emph{initiation} and \emph{propagation} phases of defect evolution. Specifically, we will investigate the fracture mechanics criterion for an existing phase-field crack to \emph{initiate}, and then to \emph{propagate} along a certain path. This experiment constitutes a numerical verification of the generalized Griffith criterion given in \cref{prop:Ggriffithlaw} and its asymptotic interpretation outlined in \cref{prop:whenellpetit}. Recall that these properties can also be considered as a dynamic extension of the theoretic results established in \cite{SicsicMarigo:2013} for quasi-static gradient damage models. Another objective is to investigate the quasi-static limit of the dynamic model summarized in \cref{def:dynagraddama}. The thematic subjects covered here are thus summarized in \cref{tab:summanti}.
\begin{table}[htbp]
\centering
\caption{Thematic subjects covered in this section} \label{tab:summanti}
\begin{tabular}{ccccc} \toprule
& Going dynamical & $\alpha\leftrightarrow\phi$ & $\nabla\alpha\to\Gamma$ & Experimental validation \\ \midrule
Theoretics & & & & \\
Numerics & \rightthumbsup & & \rightthumbsup & \\ \bottomrule
\end{tabular}
\end{table}

\paragraph{Problem setting} We consider a mode-\RNN{3} antiplane tearing of a two dimensional plate $\Omega=[0,L]\times[-H,H]$ subject to a hard device $\vec{U}_t=\operatorname{sgn}(y)kt\,\vec{e}_3$ on its left border $x=0$, see \cref{fig:antiplane}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.45\textwidth]{antiplane.pdf}
\caption{Mode III antiplane tearing of a two dimensional plate $\Omega=[0,L]\times[-H,H]$ with a loading speed parametrized by $k$. An initial crack $[0,l_0]\times\set{0}$ is present in the domain. The crack is enforced to propagate along the constant direction $\vec{e}_1$} \label{fig:antiplane}
\end{figure}
An initial damage field corresponding to a preexisting crack $\Gamma_0=\set{\vec{x}\in\mathbb{R}^2|\alpha_0(\vec{x})=1}=[0,l_0]\times\set{0}$ is present in the domain. For that we prescribe naturally $\dvec^{-1}=1$ on $\Gamma_0$ using \cref{algo:init}. The loading velocity $k$ will be varied and its effect on the crack propagation speed will be studied. With a modification of the damage dependence of the elastic energy $\mathcal{E}(\vec{u}_t,\alpha_t)$ proposed in \cite{Bourdin:2011}, the crack tip $t\mapsto\vec{P}_t$ is enforced to propagate along the constant direction $\vec{e}_1$, which prohibits consequently crack kinking or branching. Denoting $u$ as the out-of-plane displacement, the elastic energy density \eqref{eq:elasticG} in this particular situation reads
\begin{equation} \label{eq:straightmode3}
\psi(\nabla u_t,\alpha_t)=\frac{1}{2}\mu\left(a(\alpha_t)\left(\frac{\partial u_t}{\partial x_2}\right)^2+\left(\frac{\partial u_t}{\partial x_1}\right)^2\right)\,,
\end{equation}
where damage acts only on the $\partial_2 u$ component of the displacement gradient. We assume that this modification \eqref{eq:straightmode3} can be regarded as a particular case of the original model \eqref{eq:elasticG} when the crack actually propagates along a specific path without kinking or branching. It allows us to focus on the crack propagation stage.

\begin{remark}
If the original model is used, \emph{i.e.} when the degradation function also acts on $\frac{\partial u_t}{\partial x_1}$, numerically it is observed that for low propagation speeds crack curving (including kinking and branching) does not take place and the modification \eqref {eq:straightmode3} produces the same response as the original model. However for higher propagation speeds (for example due to a larger loading velocity $k$), crack curving is observed (see for example \cite{Bourdin:2011}) and these two models no longer predict the same crack evolution. Crack path prediction is exactly the \emph{raison d'être} of phase-field models of fracture. An investigation of crack kinking/branching phenomena is a very important task and will be separately considered in \cref{sec:kinking} and \cref{sec:branching}. Nevertheless, the current contribution focuses on the behavior of gradient damage models when these dynamic instabilities (kinking, branching) are somehow suppressed (see for example \cite{LivneBen-DavidFineberg:2007} for an experimental investigation on this point), which permits a direct comparison with the classical Griffith's theory of dynamic fracture.
\end{remark}

This problem is initially raised in \cite{Bourdin:2011}. In their model the crack surface energy is approximated by the Ambrosio and Tortorelli elliptic regularization (the \eqref{eq:at2} model), whereas here the damage constitutive law \eqref{eq:at1} is used. The objective is to compare the crack evolution obtained in the dynamic gradient damage model with that predicted by Griffith's law which determines initiation and propagation of cracks. Two experiments will be considered:
\begin{enumerate}
\item In the first case, the fracture toughness $\gc$ is assumed to be homogeneous throughout the domain. The loading speed is of the same order of the material sound speed $c=\sqrt{\mu/\rho}$ and we will use the explicit Newmark time-stepping method, \emph{i.e.} \cref{algo:explicit}.

\item In the second case, $\gc$ may admit a spatial discontinuity in the propagation direction. We also prescribe a relatively small loading speed in order to investigate the quasi-static limit of the dynamic model. Depending on whether the crack propagation speed itself is smaller with respect to the sound speed or not (the term \emph{unstable} propagation often refers to this case), the implicit (\cref{algo:implicit}) or the explicit Newmark method will be used.
\end{enumerate}

A rescaling of the displacement and a normalization of the space/time scales are performed to obtain a non-dimensional problem. Specifically, a reference elastic constant $\overline{\mu}$, material density $\overline{\rho}$ and fracture toughness $\overline{\gc}$ have been chosen and the displacement is scaled by a factor of
\[
\overline{u}=\sqrt{\overline{\gc}H/\overline{\mu}}.
\]
The height of the plate $H$ and the corresponding time $H/\overline{c}$ for the reference elastic wave (with speed $\overline{c}=\sqrt{\overline{\mu}/\overline{\rho}}$) to travel such distance is used to normalize the spatial and temporal scales. We have thus
\begin{align*}
\vec{u}(\vec{x},t) &= \overline{u}\,\uhat\left(\frac{\vec{x}}{H},\frac{\overline{c}t}{H}\right)\vec{e}_3\,, \\
\alpha(\vec{x},t) &= \ahat\left(\frac{\vec{x}}{H},\frac{\overline{c}t}{H}\right)\,.
\end{align*}
Rewriting Lagrangian defined in \eqref{eq:action} using $\uhat$ and $\ahat$ amounts to adopt the following non-dimensional quantities
\[
\widehat{\rho}=\frac{\rho}{\overline{\rho}}\,,\quad \widehat{\mu}=\frac{\mu}{\overline{\mu}}\,,\quad \widehat{\gc}=\frac{\gc}{\overline{\gc}}\quad\text{and}\quad\widehat{\ell}=\frac{\ell}{H}.
\]
For notational simplicity, we drop the bar and use directly non-dimensional quantities in the sequel.

A structured crossed triangular mesh with a uniform discretization spacing $\Delta x=\Delta y=h$ is generated. For the explicit time-stepping method, the Courant–Friedrichs–Lewy (CFL) time-step is used
\begin{equation} \label{eq:tcfl}
\Delta t_\mathrm{CFL}=\frac{h}{c}=\frac{h}{\sqrt{\mu/\rho}}.
\end{equation}
The parameters adopted for all subsequent calculations are summarized in \cref{tab:paraanti}.
\begin{table}[htbp]
\centering
\caption{Geometric, material and numerical parameters for the antiplane tearing experiment} \label{tab:paraanti}
\begin{tabular}{lllllllll} \toprule
$L$ & $H$ & $l_0$ & $\mu$ & $\rho$ & $\gc$ & $\eta$ & $h$ & $\Delta t$\\ \midrule
5 & 1 & 1 & 0.2 & 1 & 0.01 & 0.05 & 0.01 & $\Delta t_\mathrm{CFL}$ \\ \bottomrule
\end{tabular}
\end{table}
A typical damage field obtained in this simulation is illustrated in \cref{fig:antiplane_2d_new}, where the damage varies from 0 (blue zones) to 1 (red zones). Thanks to the $\Gamma$-convergence result summarized in \cref{sec:fm98,sec:graddamage}, the current crack length $l_t$ could be approximately derived from the damage dissipation energy using the estimation \eqref{eq:gammaconvergence}. For the \eqref{eq:at1} model, the coefficient $c$ in \eqref{eq:gceff} reads $c=3/8$ (see \cite{HossainHsuehBourdinBhattachary:2014}), hence the following effective fracture toughness is used
\[
(\gc)_\mathrm{eff}=\left(1+\frac{3h}{8\eta}\right)\gc.
\]
However \eqref{eq:gammaconvergence} does not immediately apply to the case where $\gc$ admits a spatial discontinuity. For consistency, the current crack tip $\vec{P}_t=(l_t,0)$ is located on the contour $\alpha=0.5$. The crack speed can thus be obtained by a linear regression analysis during the steady propagation phase.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.65\textwidth]{antiplane_2d_new.pdf}
\caption{Typical damage field obtained in the antiplane tearing example. The damage varies from 0 (blue zones) to 1 (red zones)} \label{fig:antiplane_2d_new}
\end{figure}

\subsection{Link between damage and fracture in dynamics} \label{sec:homo}
\paragraph{Comparison with the Griffith's theory of dynamic fracture} In the first case a homogeneous plate will be considered. This antiplane tearing example is physically similar to the 1-d film peeling problem which can be studied using the classical Griffith's theory of dynamic fracture. According to \cite{DumouchelMarigoCharlotte:2008} and \cite{BourdinFrancfortMarigo:2008}, the crack speed, with respect to the loading displacement $U=kt$ or to the physical time $t$, as a function of the loading velocity $k$, is given by
\begin{equation} \label{eq:dumouchel}
\frac{\mathrm{d} l}{\mathrm{d} U}(k)=\sqrt{\frac{\mu H}{\gc+\rho Hk^2}}\quad\text{or}\quad\frac{\mathrm{d} l}{\mathrm{d} t}(k)=\sqrt{\frac{\mu Hk^2}{\gc+\rho Hk^2}}
\end{equation}
from which we retrieve the quasi-static limit $\mathrm{d} l/\mathrm{d} U(0)=\sqrt{\mu H/\gc}$ predicted in \cite{BourdinFrancfortMarigo:2008} and the dynamic limit as the shear wave speed $\mathrm{d} l/\mathrm{d} t(\infty)=\sqrt{\mu/\rho}$, which is a classical result of the Griffith's theory of dynamic fracture, see \cref{sec:griffithfreund}. We also observe that for low loading speeds $k\approx 0$, the dynamic crack speed $\mathrm{d} l/\mathrm{d} t\approx k\sqrt{\mu H/\gc}$ scales linearly in $k$, which agrees with the remark given in \cite{Bourdin:2011}. Comparisons between the numerical results using the dynamic gradient model and this theoretic result \eqref{eq:dumouchel} with $\gc$ replaced by $(\gc)_\mathrm{eff}$ are illustrated in \cref{fig:mode3}.
\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{crack_speed.pdf}
\caption{Crack speeds as a function of the loading velocity. The crack speed respect to $t$ is indicated in (a), while in (b) the crack speed with respect to $U$ is used. Comparison with the 1-d analytical solution \eqref{eq:dumouchel} based on the Griffith's criterion} \label{fig:mode3}
\end{figure}
Despite the transverse wave reflection present in the two-dimensional numerical model, a very good quantitative agreement is found between them. In particular, as it is also observed in \cite{Bourdin:2011}, the numerically obtained crack speed indeed approaches the limiting shear wave speed when the loading speed increases. The explicit time-stepping described in \cref{algo:explicit} as well as its FEniCS implementation work fine even at supersonic loading speeds.

\paragraph{Verification of Griffith's law} Next we investigate how exactly the crack propagates in the dynamic gradient damage model, \emph{i.e.} provide a fracture mechanics interpretation of the three physical principles given in \cref{def:dynagraddama}. We propose hence to verify the generalized Griffith criterion (\cref{prop:Ggriffithlaw}) and the asymptotic interpretation (\cref{prop:whenellpetit}), by comparing the conventional dynamic energy release rate $G^\alpha_t$ and the damage dissipation rate $\gamma_t$. Written in the form of \eqref{eq:GtC}, $G^\alpha_t$ involves an integral in the cells and hence is more convenient and accurate compared to a path integral ($J$-integral for instance) in a finite element calculation. The use of traditional $J$-integrals in a gradient damage or phase-field modeling of fracture can be found in \cite{HossainHsuehBourdinBhattachary:2014,KlinsmannRosatoKamlahMcMeeking:2015} for instance.

A widely used definition of the virtual perturbation \cite{DestuynderDjaouaLescure:1983} is recalled as follows. Suppose that the crack $\Gamma_t$ lies on the $x$-axis and its current crack tip $\vec{P}_t=(l_t,0)$ is propagating along the $\vec{e}_1$ direction. The virtual perturbation $\vtheta_t$ which introduces a fictive crack advance admits the form $\vtheta_t=\theta_t\vec{e}_1$. The construction of the continuous scalar field $0\leq\theta_t\leq 1$ parametrized by two radii $r<R$ is given in \cref{fig:thetaAnt}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.7\textwidth]{theta_field.pdf}
\caption{A particular virtual perturbation $\vtheta_t=\theta_t\vec{e}_1$ parametrized by two radii $r<R$. We have $\theta_t=1$ inside the ball $B_r(\vec{P}_t)$, $\theta_t=0$ outside the ball $B_R(\vec{P}_t)$, and a linear interpolation in between} \label{fig:thetaAnt}
\end{figure}

The conventional dynamic energy release rate \eqref{eq:GtC} is numerically computed and the validity of the asymptotic Griffith's law (\cref{prop:whenellpetit}) is analyzed by varying the inner radius $r$ of virtual perturbations defined in \cref{fig:thetaAnt}. During the propagation phase $\dot{l}_t>0$, three arbitrary time instants are taken when the crack length attains respectively $l_t\approx 1.6$, $l_t\approx 2$ and $l_t\approx 2.4$. An evident $r$-dependence of $G^\alpha_t$ is illustrated in \cref{fig:indvelocity}, where the ratio $R/r=\frac{5}{2}$ is fixed.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\textwidth]{Gtheta_of_r.pdf}
\caption{Conventional dynamic energy release rate $G^\alpha$ as a function of the inner radius $r$ of the virtual perturbation $\vtheta_t$ with a fixed ratio $R/r=\frac{5}{2}$. Three arbitrary instants when the crack propagates $\dot{l}_t>0$ are chosen} \label{fig:indvelocity}
\end{figure}
In the Griffith's theory of linear elastic dynamic fracture, according to \cref{prop:J}, the energy release rate $G_t$ is independent of the virtual perturbation field $\vtheta_t$ since it is related directly to the dynamic stress intensity factors at the crack tip. In gradient damage models however, there is no more stress singularities. When $r$ is small, we go directly into the process zone (crack tip problem) dominated by damage-induced strain softening and $G^\alpha_t\to 0$ is expected as $r\to 0$. However, as $r$ increases, $G^\alpha_t$ captures well the outer mechanical fields of the outer Griffith's fracture problem. An equivalent energy release rate can thus be defined, and according to \cref{prop:whenellpetit}, we have the desired result $G^\alpha_t=\gamma_t\to (\gc)_\mathrm{eff}$.

We will then turn to the evolution of the conventional dynamic energy release rate when the existing crack initiates and further propagates. From the above $r$-dependence analysis, a fixed inner radius $r=2\eta$ is used which should already correctly capture the far mechanical fields. The crack length $l_t$ given by \eqref{eq:gammaconvergence} as well as the calculated $G^\alpha_t$ are given as a function of the loading displacement in \cref{fig:evoGtGc}, where three separate calculations corresponding to three loading speeds $k$ are reported.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.55\textwidth]{dyn_Gtheta_k.pdf}
\caption{Conventional dynamic energy release rate $G^\alpha$ as a function of the loading displacement. Three loading speeds $k$ are used: $k=0.1\approx 0.2c$, $k=0.2\approx 0.4c$ and $k=0.3\approx 0.7c$} \label{fig:evoGtGc}
\end{figure}
Recall that an initial crack of length 1 is present in the body and we observe $G^\alpha_t=0$ before the waves arrive at the initial crack tip. When the energy release rate $G^\alpha_t$ at the initial crack tip attains the fracture toughness $(\gc)_\mathrm{eff}$, the existing crack $\Gamma_0=[0,1]\times\set{0}$ initiates and then propagates with the equality $G^\alpha_t=(\gc)_\mathrm{eff}$ if the spatial and temporal numerical discretization errors are ignored. Indeed this equality is not enforced algorithmically during the solving of the $(\vec{u},\alpha)$ evolution which is instead determined by \cref{algo:explicit}. We may conclude that the crack-tip evolution (initiation and propagation) is well governed by the asymptotic Griffith's law (\cref{prop:whenellpetit}) in the dynamic gradient damage model, when outer fields are considered.

The internal length $\ell$ (hence the maximal material stress \eqref{eq:sigc0}) plays a rather subtle role during the propagation phase. The crack tip is governed by the asymptotic Griffith's law (\cref{prop:whenellpetit}) if and only if a separation of scales between the inner damage problem and the outer LEFM is possible, \emph{i.e.} only when the internal length is sufficiently small compared to any other structural length. Although $\ell$ is indeed hidden in \cref{prop:whenellpetit}, the validity of the latter depends directly on it. Below we present the simulation results with a fixed loading speed $k=0.2$ and three small enough internal lengths. As can be seen from \cref{fig:evoGtGcell}, the crack evolution is globally conforming with Griffith's law, as long as the involved quantities are calculated with a virtual perturbation $\vtheta_t$ capturing correctly the far fields. Here according to \cref{fig:indvelocity}, we use an inner radius adapted with the internal length $r=2\eta$, which should produce an error less than $3\%$.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.55\textwidth]{dyn_Gtheta_ell.pdf}
\caption{Crack evolution as a function of the loading displacement. Three small enough internal lengths are used} \label{fig:evoGtGcell}
\end{figure}

The stress distribution along a vertical slice $\set{(x,y)\in\mathbb{R}^2|x=l_t}$ passing by the current crack tip $\vec{P}_t$ will illustrate and highlight the separation of scales when $\ell$ is small. For the sake of simplicity, we consider a stationary crack $[0,2]\times\set{0}$ and solve the static problem with the gradient damage model and the LEFM model (linear elastic body with a sharp crack embedded in the domain). On the one hand, we can verify from \cref{fig:stress} that the LEFM develops a well-known inverse square root singularity for the two stress components $\sigma_{13}$ and $\sigma_{23}$ and their near-tip fields are well approximated by the theoretic asymptotic solutions.
\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{asymptotic-sig.pdf}
\caption{Stress distribution along a vertical slice $\set{(x,y)\in\mathbb{R}^2|x=l_t}$ passing by the current crack tip $\vec{P}_t$. The $\sigma_{13}$ (a) and the $\sigma_{23}$ (b) components are indicated. The gradient damage model and the LEFM model are compared} \label{fig:stress}
\end{figure}
On the other hand, the gradient damage model provides a better modeling of the stress field near the crack tip as their values are bounded. A good matching can be observed far from the crack tip whereas the discrepancy with the outer LEFM model is concentrated within a process zone proportionally dependent on the internal length. When $\ell$ is very large, the process zone could cover the whole structural domain and a separation of scales is no longer possible. In this case the asymptotic Griffith's law (\cref{prop:whenellpetit}) is not applicable since we are no longer dealing with a fracture mechanics problem.

\subsection{Quasi-static limit of the dynamic model}
As another illustration of the Griffith-conforming crack evolution obtained with the dynamic gradient damage model, we consider the quasi-static limits of the model in the presence of a possible fracture toughness discontinuity in the previous plate
\[
\gc=\begin{cases}
K_1 & x\leq x_0 \\
K_2 & x>x_0
\end{cases}
\]
A preexisting crack is always present and is introduced via an initial damage field.

A theoretic convergence investigation of the dynamic gradient damage model with a vanishing loading speed $k\to 0$ is performed in \cite{Versieux:2015}. The analysis is based on the hypothesis that the crack evolution $t\mapsto l_t$ is at least continuous in time (as in the classical Griffith's theory). This implies that in the presence of brutal or unstable crack propagation, the convergence may not be observed. Nevertheless in the absence of these situations, the dynamic gradient damage model (\cref{def:dynagraddama}) should converge to the following
\begin{definition}[First-Order Quasi-Static Gradient Damage Evolution Law] \label{def:firstorderqs} \noindent
\begin{enumerate}
\item \textbf{Irreversibility}: the damage $t\mapsto\alpha_t$ is a non-decreasing function of time.

\item \textbf{First-order stability}: the first-order variation of the potential energy is non-negative with respect to arbitrary admissible displacement and damage fields
\begin{equation} \label{eq:viqs}
\mathcal{P}'(\vec{u}_t,\alpha_t)(\vec{v}_t-\vec{u}_t,\beta_t-\alpha_t)\geq 0\text{ for all $\vec{v}_t\in\mathcal{C}_t$ and all $\beta_t\in\mathcal{D}(\alpha_t)$}.
\end{equation}

\item \textbf{Energy balance}: the only energy dissipation is due to damage such that the energy balance condition \eqref{eq:qseb} is satisfied.
\end{enumerate}
\end{definition}

Compared to the original quasi-static model (\cref{def:qsgraddama}),  the more general meta-stability principle \eqref{eq:qsstability} is replaced by its first-order condition \eqref{eq:viqs}. However as it is noted in \cref{sec:ellipticregul}, numerically it is the first-order stability condition \eqref{eq:viqs} that is effectively implemented by the alternate minimization procedure, while the energy balance condition \eqref{eq:qseb} can only be at best checked \emph{a posteriori}. From this viewpoint, \cref{def:firstorderqs} can thus be considered as the effective quasi-static gradient-damage model.

\paragraph{Homogeneous case $K_1=K_2$} The homogeneous antiplane tearing problem is firstly solved by the dynamic gradient damage model and the above first-order quasi-static gradient damage model. In the dynamic calculation a small loading speed $k=0.001\approx 0.2\%c$ is assumed and we use the unconditionally stable implicit Newmark scheme as described in \cref{algo:implicit}, with $\beta=\frac{1}{4}$. The time step is set to $\Delta t=10\Delta t_\mathrm{CFL}$. In \cref{fig:homoGcqs} we plot the crack length evolution as well as the conventional energy release rate $G^\alpha_t$ both for the dynamic model and the first-order quasi-static model.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.55\textwidth]{dyn_qs.pdf}
\caption{Crack length and conventional energy release rate $G^\alpha$ for the homogeneous fracture toughness plate at a very slow loading speed. Comparison between the dynamic model and the first-order quasi-static model} \label{fig:homoGcqs}
\end{figure}
It is recalled that the static $G^\alpha_t$ can be simply obtained by setting $\dot{\vec{u}}_t$ and $\ddot{\vec{u}}_t$ to zero in \eqref{eq:GtC}. We observe that these two solutions coincide, and both present a time-continuous crack evolution (initiation and propagation) conforming to the asymptotic Griffith's law (\cref{prop:whenellpetit}). The numerically computed quasi-static crack speed (with respect to $U=kt$) is compared in \cref{tab:compqsv} to the analytical value $\sqrt{\mu H/\gc}$ announced in \cite{BourdinFrancfortMarigo:2008}. A very good agreement can be found if the numerically amplified fracture toughness $(\gc)_\mathrm{eff}$ is used in the formula.
\begin{table}[htbp]
\centering
\caption{Comparison of the numerically computed quasi-static crack speed in the homogeneous case with the theoretic one $\sqrt{\mu H/\gc}$ given in \cite{BourdinFrancfortMarigo:2008}} \label{tab:compqsv}
\begin{tabular}{lllll} \toprule
& Numerical & Theoretic & Error \\ \midrule
Quasi-static crack speed & 4.326 & 4.391 & 1.5\% \\ \bottomrule
\end{tabular}
\end{table}

\paragraph{When $K_1<K_2$} We then turn to the case where the fracture toughness jumps suddenly from a lower value $K_1=0.01$ to a higher one $K_2=2K_1=0.02$ at $x=2$. The unconditionally stable implicit Newmark scheme with $\beta=\frac{1}{4}$ is used again with a time increment $\Delta t=10\Delta t_\mathrm{CFL}$. As can be observed from \cref{fig:hardGcqs} the convergence of the dynamic model toward the quasi-static one is verified and the crack initiates and propagates following Griffith's law. A temporary arrest phase is present shortly after the crack reaches the interface at $x=2$. Due to continuous loading the energy release rate increases and the crack then restarts and begins to propagate in the second material when the energy release rate $G^\alpha_t$ attains the higher fracture toughness $K_2$.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.55\textwidth]{dyn_hardening.pdf}
\caption{Crack length and conventional energy release rate $G^\alpha$ for the hardening fracture toughness plate at a very slow loading speed. Comparison between the dynamic model and the first-order quasi-static model. The numerically amplified fracture toughness $(\gc)_\mathrm{eff}$ is calculated based on $K_1=0.01$} \label{fig:hardGcqs}
\end{figure}

\paragraph{When $K_1>K_2$} However, for the case where the fracture toughness $K_1=2K_2=0.02$ suddenly drops to a smaller value $K_2=0.01$ at $x=1$ (exceptionally here the initial crack length is $\frac{1}{4}$), a relatively good matching can only be found before and after the jump phase produced at the discontinuity, both in terms of the crack length evolution and the energy release rate. It is exactly at the jump phase that these two models strongly disagree, cf. \cref{eq:ressoftening}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.55\textwidth]{dyn_softening.pdf}
\caption{Crack length and the conventional energy release rate $G^\alpha$ for the softening fracture toughness plate at a very slow loading speed. Comparison between the dynamic model and the first-order quasi-static model. The numerically amplified fracture toughness $(\gc)_\mathrm{eff}$ is calculated based on $K_2=0.01$} \label{eq:ressoftening}
\end{figure}
Here due to the unstable crack propagation during the jump, the explicit Newmark scheme is used for the dynamic calculation with $\Delta t=\Delta t_\mathrm{CFL}$. When the crack arrives at the discontinuity, the \emph{first-order} quasi-static \emph{numerical} model underestimates the crack jump and predicts no further crack arrest, by relating directly the static energy release rate $G^\alpha_t$ to the fracture toughness $K_2$ just after the jump. For the dynamic model, the jump length is bigger and a subsequent temporary crack arrest is observed, as the dynamic energy release rate oscillates with a high frequency but remains smaller than the fracture toughness $K_2$ after the jump. We observe that in both cases the jump takes place at $x\approx 0.9$ somewhat prior to the fracture toughness discontinuity $x=1$. We suspect that this is due to the damage regularization of cracks with a half-band $D=2\eta=0.1$ using the constitutive laws of \eqref{eq:at1}. The crack length after the jump with this effect ignored is recorded in \cref{tab:compljump} for each case. From the static energy release rate evolution, we see that the crack length $l_\mathrm{m}$ after the jump predicted in the \emph{first-order} quasi-static \emph{numerical} model is governed by $G(l_\mathrm{m})=\gc(l_\mathrm{m})$ from which authors of \cite{DumouchelMarigoCharlotte:2008} find $l_\mathrm{m}=\sqrt{K_1/K_2}=\sqrt{2}$. However their dynamic analysis shows that the crack length after the jump $l_\mathrm{c}$ should instead be given by the total (quasi-static) energy conservation principle $\mathcal{P}(1)=\mathcal{P}(l_\mathrm{c})$, which results in $l_\mathrm{c}=K_1/K_2=2$. We see from \cref{tab:compljump} that our dynamic gradient damage model indeed reproduces this correct value.
\begin{table}[htbp]
\centering
\caption{Comparison of the numerical crack lengths after the jump with the theoretic predictions} \label{tab:compljump}
\begin{tabular}{lll} \toprule
& Quasi-static & Dynamic \\ \midrule
Numerical & 1.465 & 1.995 \\
Theoretic & $\sqrt{2}$ & 2 \\
Error & 3.6\% & 0.25\% \\ \bottomrule
\end{tabular}
\end{table}

To better analyze the jump phase, energy evolutions are investigated against the crack length in \cref{fig:evoRNJjump}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\textwidth]{dynqsET_softening.pdf}
\caption{Energy variation as a function of the crack length for the softening fracture toughness plate at a very slow loading speed. Comparison between the dynamic model and the first-order quasi-static model} \label{fig:evoRNJjump}
\end{figure}
In the quasi-static case we pick the total energy $\mathcal{P}=\mathcal{E}+\mathcal{S}$ while in the dynamic case we plot separately the static energy $\mathcal{P}=\mathcal{E}+\mathcal{S}$ and the kinetic one $\mathcal{K}$. Before and sufficiently after the jump a good agreement between these two potential energies can be found. We observe that the (incorrect) quasi-static jump (\emph{i.e.}, an \emph{unstable} or \emph{brutal} crack propagation) is accompanied by a slight loss of the total energy $\Delta \mathcal{P}_\mathrm{stat.}$, contradicting the balance condition \eqref{eq:qseb}. This phenomenon has already been observed by several authors such as \cite{BourdinFrancfortMarigo:2008,AmorMarigoMaurini:2009,PhamAmorMarigoMaurini:2011,Bourdin:2011}. On the one hand, it can be regarded as a numerical issue as the effective implementation of the quasi-static model is solely based on the first-order stability condition \eqref{eq:viqs}. For this particular problem based on quasi-static energy conservation we could predict a correct quasi-static crack evolution toward which the dynamic solution converges when the loading speed becomes small, see \cite{DumouchelMarigoCharlotte:2008}. On the other hand, from a theoretic point of view, it is already known in \cite{Pham:2010} that there may not exist an energy-conserving evolution which also respects the stability criterion at every time. Moreover even equipped with the energy balance condition, the quasi-static model may still differ from the dynamic analysis \cite{LazzaroniBargelliniDumouchelMarigo:2012}. A natural and physical remedy for all general unstable crack propagation cases is to introduce inertial effects. In \cref{fig:evoRNJjump} the dynamic jump process is \emph{continuous} (the crack propagates at a finite speed bounded by the shear wave speed) compared to the quasi-static one where the jump occurs necessarily in a discontinuous fashion between two iterations. We verify the conclusions drawn in \cite{DumouchelMarigoCharlotte:2008} that the kinetic energy $\mathcal{K}$ plays only a transient role in this problem, as it attains a finite value during the jump and becomes again negligible after. The dynamic potential energy $\mathcal{P}=\mathcal{E}+\mathcal{S}$ after the jump is slightly bigger that its value before the jump, due to the fact that the loading speed $k=0.001$ is small but not zero.

During the jump, the crack propagates at a speed comparable to the material speed of sound which, according to \cite{DumouchelMarigoCharlotte:2008}, is given by
\begin{equation} \label{eq:vjump}
v_\mathrm{jump}=\frac{\left(\sqrt{\widehat{K}_1+\epsilon^2}+\epsilon\right)^2-\widehat{K}_2}{\left(\sqrt{\widehat{K}_1+\epsilon^2}+\epsilon\right)^2+\widehat{K}_2}\cdot c
\end{equation}
with the non-dimensional fracture toughness $\widehat{K}_i=K_i/(2\mu H)$ and the normalized loading speed $\epsilon=k/c$. The crack length evolution during the jump is illustrated in \cref{fig:softGcqs_jump}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\textwidth]{jump.pdf}
\caption{Zoom in time at the crack length jump due to sudden toughness softening for the dynamic model} \label{fig:softGcqs_jump}
\end{figure}
Due to transverse wave reflection in this 2-d problem, the crack propagates during this interval with a small fluctuation of period $T$ approximately corresponding to the first standing wave between the boundary and the crack $T\approx 2H/c\approx 4.5$. That is why we calculate from \cref{fig:softGcqs_jump} only the initial crack speed at jump for comparison in \cref{tab:compjumpv}. A good agreement can be found between the numerical and the theoretic ones.
\begin{table}[htbp]
\centering
\caption{Comparison of the numerically computed crack jump speed with the theoretic one \eqref{eq:vjump} given in \cite{DumouchelMarigoCharlotte:2008}} \label{tab:compjumpv}
\begin{tabular}{llll} \toprule
& Numerical & Theoretic & Error \\ \midrule
Relative jump speed $v_\mathrm{jump}/c$ & 0.3325 & 0.3396 & 2\% \\ \bottomrule
\end{tabular}
\end{table}

\subsection*{Conclusion}
Further physical insights into the dynamic gradient damage model are provided via a simple antiplane tearing experiment. As a phase-field approach to brittle fracture, it can indeed be regarded as a generalization or a superset of the LEFM theory, since the crack evolution is shown to be Griffith-conforming in several situations:
\begin{itemize}
\item In the dynamic tearing example of a homogeneous plate, it is verified that the crack evolution is governed by the asymptotic Griffith's law (\cref{prop:whenellpetit}), as long as the material internal length is sufficiently small to establish a separation of scales between the inner damage problem and the outer LEFM problem. The conventional dynamic energy release rate is numerically computed and verified as a tool to translate gradient damage mechanics results in fracture mechanics terminology. We conducted a comparison with the 1-d peeling problem \cite{DumouchelMarigoCharlotte:2008} analytically studied with the classical Griffith's theory of dynamic fracture. A good agreement between them can be found in terms of the crack speeds prediction as a function of the loading speed.

\item We then investigated the quasi-static limits of the dynamic gradient damage model. In the absence of \emph{brutal} or \emph{unstable} crack propagation when the classical static Griffith's theory fails, the dynamic model converges to the first-order quasi-static gradient damage model, when the loading speed decreases. However when the crack may propagate at a speed comparable to the material speed of sound, the dynamic model should be preferred in order to correctly account for inertial effects. The crack evolution in the dynamic gradient damage model is in quantitative accordance with the LEFM predictions on the 1-d peeling problem.
\end{itemize}

These numerical experiments provide hence a justification of the dynamic gradient damage model along with its current implementation, when it is used as a genuine physical model for complex real-world dynamic fracture problems.

\section{Plane Crack Kinking} \label{sec:kinking}
The three physical principles of \cref{def:dynagraddama} determine \emph{when} and \emph{how} the crack propagates. In \cref{sec:antiplane} the initiation and propagation phases of defect evolution are considered. According to \cref{sec:dynafrac}, it focuses on \emph{when} cracks propagate. In this section, we will focus on the path along which the crack propagates, \emph{i.e.} \emph{how} cracks evolve. Specifically, this section is devoted to a numerical analysis of plane crack kinking predicted by the gradient damage model. The thematic subjects covered here are thus summarized in \cref{tab:summkink}.
\begin{table}[htbp]
\centering
\caption{Thematic subjects covered in this section} \label{tab:summkink}
\begin{tabular}{ccccc} \toprule
& Going dynamical & $\alpha\leftrightarrow\phi$ & $\nabla\alpha\to\Gamma$ & Experimental validation \\ \midrule
Theoretics & & & & \\
Numerics & & & \rightthumbsup & \\ \bottomrule
\end{tabular}
\end{table}

\paragraph{Problem setting} The problem setting is adapted from \cite{HakimKarma:2005,HakimKarma:2009}. We consider a unit disk centered at the origin $\Omega=B_1(\vec{0})$ subject to a mixed-mode hard device $\vec{U}(\overline{G},K_2/K_1)$ prescribed on its boundary $\partial\Omega$, see \cref{fig:kinking}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\textwidth]{kinking_pb.pdf}
\caption{Plane crack kinking problem in a pre-cracked unit ball centered at the origin $\Omega=B_1(\vec{0})$. A hard device $\vec{U}(\overline{G},K_2/K_1)$ is prescribed on the boundary $\partial\Omega$} \label{fig:kinking}
\end{figure}
An existing \emph{stationary} plane crack $\Gamma_0=[-1,0]\times\set{0}$ is modeled by an initial damage field via $\dvec^{-1}=1$ on $\Gamma_0$, see \cref{algo:init}. In the presence of this \emph{stationary} damage field $\alpha_0$, the elasto-static displacement corresponding to the mixed-mode Dirichlet condition $\vec{U}(\overline{G},K_2/K_1)$ is pre-computed and will be used as the initial condition for the subsequent dynamic calculation. For this problem the initialization procedure is summarized in \cref{algo:init2}. The dynamic analysis is performed in an interval $[0,T]$, while the external displacement $\vec{U}(\overline{G},K_2/K_1)$ is maintained constant.
\begin{algorithm}[htbp]
\caption{Initialization for the plane crack kinking problem adapted from \cref{algo:init}} \label{algo:init2}
\begin{algorithmic}[1]\linespread{1.2}\selectfont\normalsize
\State Given initial conditions $\uvec^0=\vec{0}$, $\dot{\uvec}^0=\vec{0}$ and $\dvec^{-1}=1$ on $\Gamma_0$.
\State Reinitialize the damage by solving
\[
\dvec^0=\operatorname{arg min}q_{\,\vec{0}}(\cdot)\text{ subjected to constraints $0\leq\dvec^{-1}\leq\dvec^0\leq 1$}.
\]
\State Initialize the displacement by solving the following elasto-static problem with the previously computed $\dvec^0$
\[
\uvec^0=\operatorname{arg min}\vec{F}_\mathrm{int}(\cdot,\dvec^0)-\vec{F}_\mathrm{ext}^0(\cdot).
\]
\State Initialize the acceleration $\vec{M}\ddot{\uvec}^0=\vec{F}_\mathrm{ext}^0-\vec{F}_\mathrm{int}(\uvec^0,\dvec^0)$.
\end{algorithmic}
\end{algorithm}

The precise objective here is to compare the apparent kinking angle $\theta$ with several theoretic criteria commonly used in the Griffith's theory of fracture, cf. \cref{sec:theoexpcrit}. The prescribed displacement $\vec{U}(\overline{G},K_2/K_1)$ corresponds to the asymptotic expansion of the displacement field near the \emph{stationary} crack tip $\vec{P}_0=(0,0)$ with the opening and sliding intensity factors $K_1>0$ and $K_2\geq 0$, see \eqref{eq:singularform}. The plane stress condition is assumed. By virtue of Irwin's formula \eqref{eq:GasafunctionofK} the imposed energy release rate is given by
\[
\overline{G}=\frac{K_1^2+K_2^2}{E}.
\]
Thanks to Griffith's law (\cref{prop:Ggriffithlaw,prop:whenellpetit}) in the gradient damage model as well as its numerical verification in \cref{sec:antiplane}, to ensure that the gradient-damage crack will indeed propagate to another point $\vec{P}^*$ under $\vec{U}$, the value of $\overline{G}$ should be larger than the effective material toughness $G_0>(\gc)_\mathrm{eff}$. To represent different types of mixed-mode loading, the ratio $K_2/K_1$ will be varied and its influence on the kinking behavior will be analyzed.

A non-structured triangular mesh is used to discretize the domain $\Omega$. The damage constitutive law \eqref{eq:at1} is used. We use the explicit time stepping procedure outlined in \cref{algo:explicit} for the solving of the dynamic $(\vec{u},\alpha)$ problem. The material, loading and numerical parameters used in this problem are summarized in \cref{tab:kinking}. 
\begin{table}[htbp]
\centering
\caption{Material, loading and numerical parameters for the plane crack kinking experiment} \label{tab:kinking}
\begin{tabular}{lllllll} \toprule
$\rho$ & $E$ & $\nu$ & $\gc$ & $\eta$ & $\overline{G}$ & $h$ \\ \midrule
1 & 1 & 0.2 & 1 & 5\% or 1\% & 1.1 or 1.5 & $\eta/5$ \\ \bottomrule
\end{tabular}
\end{table}

\paragraph{Simulation results and discussion} The dynamic evolution of the damage field $\alpha_t$ is indicated in \cref{fig:kinking_t}. An apparent crack kinking is observed due to the initial mixed-mode loading condition.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.9\textwidth]{kinking_G1x5_K0x6.pdf}
\caption{Damage field evolution obtained with $\eta=1\%$ and $\overline{G}=1.5$ for $K_2/K_1=0.6$: (a) $t=0$, (b) $t=0.25$ and (c) $t=0.5$} \label{fig:kinking_t}
\end{figure}
Several simulations corresponding to different $K_2/K_1$ ratio are performed. Typical numerical results are illustrated by the damage field after kinking in \cref{fig:kinking_k2k1}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.9\textwidth]{kinking_G1x5.pdf}
\caption{Damage field obtained with $\eta=1\%$ and $\overline{G}=1.5$ for three $K_2/K_1$ ratios: (a) $K_2/K_1=0.6$, (b) $K_2/K_1=0.8$ and (c) $K_2/K_1=1$} \label{fig:kinking_k2k1}
\end{figure}
The apparent kinking angle predicted by the gradient damage model is compared in \cref{fig:kinking_comp} with several commonly used kinking criteria in fracture mechanics, see \cref{sec:theoexpcrit}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\textwidth]{kinking_comp.pdf}
\caption{Apparent kinking angle predicted by the gradient damage model compared with some commonly used kinking criteria in fracture mechanics} \label{fig:kinking_comp}
\end{figure}
The influence of the mixed-mode ratio $K_2/K_1$, the internal length $\ell$ and the intensity of the prescribed displacement $\overline{G}$ is analyzed as follows. 
\begin{itemize}
\item Numerically obtained kinking angles are conforming to the theoretic predictions of several kinking criteria in fracture mechanics. In the isotropic case, the PLS, the $\sigma_{\theta\theta}$-max and the $G$-max criteria give similar kinking angles, see for instance \cite{ChambolleFrancfortMarigo:2009}. Anisotropy may be needed to distinguish between them, cf. \cite{HakimKarma:2005}.

\item The internal length $\ell$, or equivalently the maximal stress \eqref{eq:sigc0}, again plays a subtle role here similarly to the antiplane problem in \cref{sec:antiplane}. From \cref{fig:kinking_comp}, the kinking angle shows little dependence with respect to the internal length used. This confirms that as long as the internal length is sufficiently small compared to that of the body, the gradient-damage crack behaves just like a real sharp-interface crack.

\item The intensity $\overline{G}$ determines how brutal the kinking process is, which can be measured by the post-kink add-crack length $\delta l$. According to the simulation results, a smaller $\overline{G}$ produces also a smaller $\delta l$. However the kink angle seems independent of $\overline{G}$ in \cref{fig:kinking_comp}.

\item By comparing the three figures in \eqref{fig:kinking_k2k1}, it can be observed that the mixed-mode ratio $K_2/K_1$ also determines how unstable the crack propagation is during the kink. In particular, a larger $K_2/K_1$ leads to a larger $\delta l$. This point needs further theoretical investigation in the future.
\end{itemize}

In this section the kinking of an initially stationary crack is analyzed by the gradient damage model. Dynamics are not expected to play an essential role during such process. For a crack propagating at a given velocity, the spatial path undertaken by the crack could be different (kinking and/or branching). Future work could be devoted to a thorough dynamic analysis of this problem.

\section{Dynamic Crack Branching} \label{sec:branching}
In this section we will study the dynamic crack branching problem for a 2-d plane stress glass plate under constant pressure applied on its upper and lower boundaries. This particular problem has already been investigated within the phase-field community \cite{BordenVerhooselScottHughesLandis:2012,SchlueterWillenbuecherKuhnMueller:2014} where the numerical convergence aspect as well as some physical insights into the branching mechanism are analyzed. Here in this work we will first focus on the computational efficiency of \cref{algo:explicit} implemented in the EPX software as well as the possible use of several damage constitutive laws to approximate fracture. This last strengthens the bridge between the phase-field and the gradient-damage communities. Finally we provide some fracture mechanics interpretations of the branching mechanism predicted in the gradient damage model. The thematic subjects covered here are thus summarized in \cref{tab:summbranching}.
\begin{table}[htbp]
\centering
\caption{Thematic subjects covered in this section} \label{tab:summbranching}
\begin{tabular}{ccccc} \toprule
& Going dynamical & $\alpha\leftrightarrow\phi$ & $\nabla\alpha\to\Gamma$ & Experimental validation \\ \midrule
Theoretics & & & & \\
Numerics & & \rightthumbsup & \rightthumbsup & \rightthumbsup \\ \bottomrule
\end{tabular}
\end{table}

\paragraph{Problem setting} The geometry as well as the loading conditions are depicted in \cref{fig:branching}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.55\linewidth]{plateres.pdf}
\caption{Geometry and loading conditions for the dynamic crack branching problem. Damage field $\alpha_t$ at $t=\SI{8e-5}{s}$ ranging from 0 (gray) to 1 (white) obtained by the \eqref{eq:at1} model} \label{fig:branching}
\end{figure}
Due to symmetry only the upper half part is modeled. The initial crack $\Gamma_0$ is introduced via an initial damage field $\dvec^{-1}$. Material parameters are borrowed from \cite{BordenVerhooselScottHughesLandis:2012} where the internal length $\eta$ is set to $\SI{0.25}{mm}$. We use a structured quadrilateral elements of equal discretization spacing $h\approx\SI{0.045}{mm}$ in both directions achieving approximately 1 million elements. The current time increment is calculated based on the CFL condition with a security factor of 0.8. An unstructured mesh should be in general preferred. However the original analysis on mesh-induced anisotropy is conducted on structured triangular elements \cite{Negri:1999}. Furthermore the numerical study of \cite{LorentzGodard:2011} shows that the crack direction is insensitive to the orientation of a structured quadrilateral grids. We firstly use the damage constitutive law \eqref{eq:at1}. The symmetric tension-compression formulation is also adopted. This choice is justified by an \emph{a posteriori} verification of non-interpenetration of matter. The simulation result is illustrated in \cref{fig:branching} by the damage field $\alpha_t$ at $t=\SI{8e-5}{s}$ ranging from 0 (gray) to 1 (white). Similar contours have been obtained in \cite{BordenVerhooselScottHughesLandis:2012,SchlueterWillenbuecherKuhnMueller:2014}.

\subsection{Computational efficiency in a parallel computing context}
The parallel computing framework for the dynamic gradient damage model has been developed by the author in the EPX software \cite{EPX:2015}. A strong scaling analysis is here conducted for several processor cores $\mathrm{NP}$ in the cluster \texttt{ASTER5} provided by the Electricité de France. We have verified that all simulations give nearly the same results in terms of global energy evolution and field contours. The difference of the elastic energy at $t=\SI{8e-5}{s}$ is within 0.2\% between the sequential and the parallel $\mathrm{NP}=16$ cases, which may be due to floating point arithmetic and different setting of preconditioners. The scaling results are given in \cref{fig:scaling}. The calculation time is partitioned into 4 items:
\begin{enumerate}
\item The ``elastodynamics'' part related to the solving of \eqref{eq:waveeqsdis},
\item The ``damage assembly'' part where the global Hessian matrix $\vec{H}$ and the second member $\vec{b}$ is constructed,
\item The ``damage solving'' part where \eqref{eq:crackstdis} is solved,
\item The ``communication'' part corresponding to the data exchange among processors.
\end{enumerate}
The computational load is well balanced and the maximum value among all processors are used. Quasi-ideal scaling is observed for the total computational time. The proportion of the ``elastodynamics'' and the ``damage assembly'' parts are decreasing, due to the increase of the ``communication'' overhead reaching 15\% with 16 cores and becoming comparable to that of the ``damage solving''.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\linewidth]{plate_scaling.pdf}
\caption{Strong scaling results for the dynamic crack branching problem with 1 million elements} \label{fig:scaling}
\end{figure}

We remark that the quadratic bound-constrained minimization problem \eqref{eq:crackstdis} solved by the GPCG scheme implemented in PETSc is not very costly and represents in sequential and parallel calculations only 13\% of the total computational time. In the phase-field literature the damage problem is often solved by an unconstrained minimization of \eqref{eq:crackstdis} corresponding to a linear system \eqref{eq:linearsystem}. The irreversibility condition is then approximated by several physical or numerical methods, see \cref{sec:phasefields}. However, it should be kept in mind that the above computationally-appealing strategy only applies to the damage constitutive law \eqref{eq:at2}, where the solution of \eqref{eq:linearsystem} lies necessarily between 0 and 1 and the objective functional \eqref{eq:qdiscrete} is indeed quadratic with respect to $\dvec$. Otherwise a specific numerical scheme for bound-constrained problems is needed. Nevertheless we would like to point out that the GPCG solver is extremely efficient even compared to the above strategy consisting of only one linear system. The same crack branching analysis is conducted using the damage constitutive model \eqref{eq:at2} and a same internal length $\eta=\SI{0.25}{mm}$, and the results obtained with the GPCG solver and the \emph{a posteriori} projection method described in \cref{sec:phasefields} are compared. In the latter case the same preconditioned conjugate gradient method is employed to solve \eqref{eq:linearsystem}. The results are slightly different as expected, since the projection method does not solve exactly the full minimization problem \eqref{eq:crackstdis}. To compare their relative computational costs, the time consumed in damage solving is separately normalized by that corresponding to the elastodynamic problem in \cref{tab:gpcg_vs_cg_proj}.
\begin{table}[htbp]
\centering
\caption{Relative damage-solving cost normalized by the time devoted to the elastodynamic part during a parallel calculation $\mathrm{NP}=16$. The damage constitutive law \eqref{eq:at2} is used. Comparison between the GPCG solver and the \emph{a posteriori} projection method} \label{tab:gpcg_vs_cg_proj}
\begin{tabular}{lll} \toprule
&  CG + projection & GPCG \\ \midrule
Damage-solving cost & 50\% & 77\% \\ \bottomrule
\end{tabular}
\end{table}

Opposed to what is suggested by \cite{AmorMarigoMaurini:2009}, the use of a bound-constrained minimization solver implies a relative computational cost only 27\% higher than a traditional linear solver. This can be seen in the normalized histogram of CG iterations per time step illustrated in \cref{fig:histcg}. We recall that each CG iteration implies a matrix-vector multiplication, the most costly part of the algorithm. When only one linear system is to be solved in the \emph{a posteriori} projection method, approximately 20 CG iterations are needed in 35\% of all time steps. When the GPCG solver is used, we observe that the histogram is more spread out and more than 50 CG iterations may be needed for some time steps. Nevertheless the distribution is more concentrated around 10 to 30 iterations.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\linewidth]{hist_cg_tao_vs_cg_proj.pdf}
\caption{Normalized histogram of CG iterations per time step. The damage constitutive law \eqref{eq:at2} is used. Comparison between the GPCG solver and the \emph{a posteriori} projection method} \label{fig:histcg}
\end{figure}

\subsection{Comparison between two damage constitutive laws}
We then turn to the choice of different damage constitutive laws from a computational and physical point of view. We take the simulation results using \eqref{eq:at1} as a reference and compare them with results obtained by the widely used damage constitutive law \eqref{eq:at2} in the phase-field modeling of fracture. The quantitative effects of the internal length actually depend on the damage constitutive model used. Here we propose two natural choices of $\ell$ in the \eqref{eq:at2} case: one corresponding to the same value $\eta=\SI{0.25}{mm}$ as used in the \eqref{eq:at1} case, the other corresponding to a same maximal tensile stress as used in the \eqref{eq:at1} case, which gives $\eta\approx\SI{0.07}{mm}$ according to \eqref{eq:sigc0} and \eqref{eq:gcingd}. The same GPCG solver is used and the relative damage-solving costs separately normalized by the time devoted to the elastodynamic part are reported in \cref{tab:at1_vs_at2}.
\begin{table}[htbp]
\centering
\caption{Relative damage-solving cost normalized by the time devoted to the elastodynamic part during a parallel calculation $\mathrm{NP}=16$. The GPCG solver is used. Comparison between different constitutive laws} \label{tab:at1_vs_at2}
\begin{tabular}{ll} \toprule
& Damage-solving cost  \\ \midrule
\eqref{eq:at1} & 32\% \\
\eqref{eq:at2} with a same $\ell$ & 77\% \\
\eqref{eq:at2} with a same $\sigma_\mathrm{m}$ & 36\% \\ \bottomrule
\end{tabular}
\end{table}

We remark that the use of the constitutive law \eqref{eq:at1} or a smaller internal length $\ell$ reduces significantly the \emph{relative} damage-solving cost. A viable explanation is given as follows. The theoretical 1-d damage profile of \eqref{eq:at2} corresponds to an exponential function without a finite support, see \eqref{eq:at2alpha}. The numerically obtained damage band, \emph{i.e.} in which $\alpha_t>0$, is much wider than in the \eqref{eq:at1} case \eqref{eq:at1alpha}. Consequently, less \emph{active} nodes are present and the GPCG solver identifies much more \emph{free} nodes for the \eqref{eq:at2} case, which induces a bigger linear system to be solved. Similarly, a reduction of the material internal length will imply finer mesh along the crack path (hence more computational cost in absolute values), however the damage is more concentrated and the \emph{relative} solving cost of \eqref{eq:crackstdis} is decreased.

The damage field $\alpha_t$ at $t=\SI{8e-5}{s}$ obtained with the constitutive law \eqref{eq:at2} is illustrated in \cref{fig:at2_ell_sigm}. Recall that the same mesh with $h=\SI{0.05}{mm}$ is used and should be sufficient for both calculations. Compared to \cref{fig:branching} obtained with \eqref{eq:at1}, the \emph{transition area} where $0<\alpha_t<1$ is more pronounced especially in \cref{fig:at2_ell_sigm} with $\eta=\SI{0.25}{mm}$, conforming to the above discussions on the damage band. Another reason behind a relatively large zone with intermediate damage values is due to the different stress-strain behavior of these two constitutive laws during a homogeneous traction experiment discussed in \cref{sec:ingredients}. In the \eqref{eq:at1} case the material possesses a purely elastic domain and damage doesn't evolve as long as the maximal stress is not reached. Then the material follows a classical softening behavior as damage grows from 0 to 1. However for the constitutive law \eqref{eq:at2} widely used in phase-field modeling, damage evolves the instant when the material is subjected to external loadings. An elastic domain is absent and stress-hardening is observed within the interval $[0,\frac{1}{4}]$. In this case the phase-field $\alpha_t$ loses its physical interpretation as \emph{damage}, and hence correctly handling and interpreting crack healing is not trivial, see \cref{sec:phasefields}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.9\textwidth]{AT2_ell_sigm.pdf}
\caption{Damage field $\alpha_t$ at $t=\SI{8e-5}{s}$ ranging from 0 (blue) to 1 (red) for the dynamic branching problem. Comparison between (a) $\eta=\SI{0.25}{mm}$ and (b) $\eta\approx\SI{0.07}{mm}$ with the same constitutive model \eqref{eq:at2}} \label{fig:at2_ell_sigm}
\end{figure}

Furthermore, this peculiar behavior of the constitutive law \eqref{eq:at2} also contributes to an overestimation of the dissipated energy, as is noted in \cite{BordenVerhooselScottHughesLandis:2012,VignolletMayBorstVerhoosel:2014}. The energy evolution in this dynamic crack branching problem is given in \cref{fig:energy_at1_at2}. It is observed that the \eqref{eq:at2} law produces a dissipated energy much bigger than the \eqref{eq:at1} case, although according to \cref{fig:at2_ell_sigm} the damage fields are similar.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\linewidth]{damage_constitutive_laws.pdf}
\caption{Energy evolution for the dynamic crack branching problem obtained with several constitutive laws} \label{fig:energy_at1_at2}
\end{figure}

As can be seen from \cref{fig:at2_ell_sigm,fig:energy_at1_at2}, apparently the results obtained with the same internal length $\ell$ resembles better the \eqref{eq:at1} calculation in \cref{fig:branching}, even though it corresponds to a smaller maximal stress than the latter case. It should be reminded that $\ell$ does not play merely the role of determination of the maximal stress as in \eqref{eq:sigc0}. From \cref{sec:linkDF,sec:antiplane,sec:kinking}, this parameter also contributes qualitatively to the separation of the outer linear elastic fracture mechanics problem and the inner crack tip problem in an asymptotic context. A smaller internal length implies a wider region outside the crack where the fracture mechanics theory may apply. We admit that the choice of this parameter is not a simple one and may constitute one of the difficulties in phase-field modeling of fracture problems.

\subsection{Physical insights into the branching mechanism} \label{sec:microbrachingstu}
Here a physical understanding of crack branching predicted by the dynamic gradient damage model is proposed. According to a brief discussion in \cref{sec:kinematics}, two different branching mechanisms can be distinguished \emph{a priori}.
\begin{enumerate}
\item The first one concerns micro-branching, where micro-cracks nucleate and propagate along the main crack.
\item The second refers to macro-branching, where the main crack splits into two or more branches.
\end{enumerate}
However it is observed experimentally that macro-branching is always preceded by the micro-branching phenomenon. Using the terminology used in \cite{SharonFineberg:1996}, micro-branches corresponds to ``frustrated'' branching events while macro-branches are ``successful'' ones. It is experimental evidence that the microstructure of the crack surface, or equivalently the fracture process zone where nonlinearities dominate, plays an essential role during such branching events, see the pioneer work of \cite{Ravi-ChandarKnauss:1984,Ravi-ChandarKnauss:1984a} and a review of these aspects in \cite{FinebergMarder:1999}. In the presence of such events, from a macroscopic modeling viewpoint the main crack propagates with an ensemble of many interacting microcracks. More energy is thus dissipated due to the evolution of these micro-branches, see \cite{SharonGrossFineberg:1996}.

In gradient damage models, the cross-section of a crack is modeled by a damage profile of a finite band proportional to the internal length, see \cref{sec:ingredients}. The fracture toughness $\gc$ can be identified by the energy consumed during the creation of an optimal damage profile \eqref{eq:defoptimaldamage} in a quasi-static setting, see \cref{sec:ingredients}. In dynamics, our numerical simulations indicate that in some circumstances the damage would develop a wider band across the gradient-damage crack, which results in an over-dissipation of energy. We suspect that this phenomenon could be considered as a macroscopic representation of micro-branching with the gradient-damage approach. In \cref{fig:micro-macro}, the final damage field obtained with the \eqref{eq:at1} model is indicated. Before a critical time $t_\mc$, the initial crack $\vec{P}_0$ propagates with an optimal damage profile $\alpha_*$. This kind of \emph{simple} propagation is theoretically and numerically investigated in \cref{sec:linkDF,sec:antiplane}. From a critical time $t_\mc$, we observe that the damage band across the crack is wider than the previous case. The continuous widening (micro-branching) eventually leads to the macro-branching of the main gradient-damage crack. 
\begin{figure}[htbp]
\centering
\includegraphics[width=0.6\linewidth]{plate-micro-macro.pdf}
\caption{Distinction between micro and macro branching in gradient damage models} \label{fig:micro-macro}
\end{figure}

The damage profile at the initial crack tip $\vec{P}_0$ and at a crack tip after this critical time $t_\mc$ is compared with the optimal damage profile in \cref{fig:plate_alpha}. In the absence of micro-branching, the damage develops an optimal damage profile across the crack if the spatial discretization error (where $\alpha=1$ in an interval of width approximately $h$, see \eqref{eq:gceff}) is ignored, see \cref{sec:ellipticregul}. However during micro-branching, the damage band is even more widened. This implies an increased damage dissipation and may be considered to represent macroscopically the interaction of micro-branches. 
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\linewidth]{plate_alpha.pdf}
\caption{Damage profile in absence (for instance at the initial crack tip $\vec{P}_0$) and in presence (for instance at a crack tip just after the critical time $t_\mc$) of micro-branching, compared with the optimal damage profile} \label{fig:plate_alpha}
\end{figure}

Now we propose to perform a zoom in time and in space at $t_\mc$ to better understand the physics behind the micro-branching event. Note that during microbranching the classical $\Gamma$-convergence estimation \eqref{eq:gammaconvergence} is no longer valid, since the damage profile varies along the main crack and not necessarily corresponds to the optimal damage profile \eqref{eq:defoptimaldamage}. It may only be used to estimate the current energy dissipation rate normalized by the quasi-static fracture toughness
\begin{equation} \label{eq:circl}
\overset{\circ}{l}_t=\frac{\dot{\mathcal{S}}_t}{(\gc)_\mathrm{eff}}
\end{equation}
where spatial discretization effect is taken into account, see \eqref{eq:gceff}. The current location of the main crack given by its length $l_t$ is tracked on the contour $\alpha_t(l_t,0)=0.95$, where $y=0$ refers to the propagation path. The current crack velocity $\dot{l}_t$ is then deduced by applying a second-order difference scheme. The comparison between $\overset{\circ}{l}_t$ and $\dot{l}_t$ is illustrated in \cref{fig:plate-v}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\linewidth]{plate_v.pdf}
\caption{Crack velocity evolution derived from the dissipated energy $\mathcal{S}$ using \eqref{eq:circl} or from the contour where $\alpha_t(l_t,0)=0.95$. $A$ denotes an instant before micro-branching, $B$ denotes the onset of micro-branching and $C$ refers to the macro-branching event} \label{fig:plate-v}
\end{figure}
Several remarks are given below.
\begin{itemize}
\item Before micro-branching (for example at the point $A$), these two estimations give the same crack velocity. It implies that in the absence of micro-branching a dynamic gradient-damage crack also dissipates the same amount of energy when propagating. This energy dissipation corresponds again to the creation of an optimal damage profile \eqref{eq:defoptimaldamage}.

\item From the point $B$ or for $t>t_\mathrm{c}$, these two estimations of the crack velocity diverge quickly. This point $B$ or the time $t_\mc$ marks the onset of micro-branching. From this point, the value of $\overset{\circ}{l}_t$ no longer measures the crack speed but only a normalized total energy dissipation due to crack propagation. According to \eqref{eq:circl}, much more energy is dissipated during the propagation of the main crack $l_t$, while its velocity $\dot{l}_t$ is well below a fraction (60\%) of the Rayleigh wave speed $c_\mathrm{R}$. In this work, we share the viewpoint announced in \cite{SharonFineberg:1996} that a lower limiting fracture velocity compared to the Griffith's theory (see \cref{sec:theoexpcrit}) can be attributed to an energy over-dissipation due to micro-branching. This leads to the definition of a velocity dependent apparent fracture toughness $\Gamma(\dot{l}_t)$ for the main crack, see \cite{SharonFineberg:1996,SharonFineberg:1999}. Note that $\Gamma(\dot{l}_t)$ is only apparent for a single macroscopic crack containing an ensemble of interacting micro-cracks. It measures the total surface creation due to not only the main crack but also micro-cracks nucleated along the previous one. However the real energy dissipated per unit crack surface creation is still constant and is given by the quasi-static $\gc$, see \cite{SharonFineberg:1996}.

\item The critical velocity $v_\mc$ above which the main crack develops micro-branches is approximately $v_\mc=\SI{0.4}{c_\mathrm{R}}$. This value agrees with the experimental evidence reported for brittle materials such as PMMA in \cite{FinebergGrossMarderSwinney:1992a}. A comprehensive review on the microbranching mechanism can be found in \cite{FinebergMarder:1999}. The gradient damage model provides thus a better modeling of the critical velocity than several theoretical approaches based on a sharp-interface crack without microbranch interaction (approximately $0.6c_\mathrm{R}$ according to Yoffe, see \cref{fig:yoffe} and $0.46c_\mathrm{R}$ obtained in \cite{KatzavAdda-BediaArias:2007}). This confirms the viewpoint shared in \cite{Ravi-Chandar:1998} that the determination of the critical speed itself $v_\mc$ calls for a theory of process zone describing nonlinear material behaviors near the crack tip. The gradient damage approach seems to be a good candidate.
\end{itemize}

The next objective is to investigate stress distribution before and at the onset of micro-branching. In particular, the hoop (circumferential) stress $\sigma_{\theta\theta}$ is analyzed near the current crack tip. Its evolution as a function of the distance to the crack $r$ and as a function of the angle $\theta$ with respect to the propagation direction ($x$-axis) are separately considered. For the latter case, at several distances $r$ from the crack tip, the hoop stresses are separately normalized by their values at $\theta=0$ which gives
\[
\Sigma_\mathrm{H}(r,\theta)=\frac{\sigma_{\theta\theta}(r,\theta)}{\sigma_{\theta\theta}(r,0)}.
\]
The angular variation of these normalized hoop stresses $\Sigma_\mathrm{H}$ will be compared to the asymptotic expansion of the stress tensor in the Griffith's theory (LEFM) given in \eqref{eq:singularform}, where the current crack speed $\dot{l}_t$ derived from the gradient damage crack tip is used in the angular functions $\vec{\Theta}_i(\theta,\dot{l})$. A least-square analysis is performed to identify the possible $\widehat{K}_\RNN{2}=K_\RNN{2}/K_\RNN{1}$ perturbation in the simulation. The hoop stress variation situated at $r=D$ is used for such analysis, since according to the analysis in \cref{sec:asymptotic} the stress outside the damage process zone contributes to the fracture behavior of the material.

Before the micro-branching event we consider an arbitrary instant $A$ in \cref{fig:plate-v} where the current crack speed $\dot{l}_t=0.26c_\mathrm{R}$). The hoop stress distribution is indicated in \cref{fig:SigT200}. To normalize the spatial distance, the damage band $D=2\eta$ is used.
\begin{figure}[htbp]
\centering
\includegraphics[width=\linewidth]{SigT200.pdf}
\caption{Hoop stress distribution before micro-branching: (a) dependence on the distance to the crack $r$ and (b) dependence on the angle $\theta$ with respect to the propagation direction. To normalize the spatial distance, the damage band $D=2\eta$ is used} \label{fig:SigT200}
\end{figure}
Several remarks are given below.
\begin{itemize}
\item Contrary to the Griffith's theory, the stress tensor is no more singular at the ``crack tip'', see also \cref{fig:stress}. The hoop stress is maximized just outside the damage band at $r\approx D=2\eta$.

\item Mode-II perturbation is not detected and the angular variation matches perfectly with the linear elastic Griffith's theory in particular for $r>D$, \emph{i.e.} outside the damage process zone. The gradient-damage crack just behaves like a Griffith crack similar to the antiplane experiment in \cref{sec:antiplane} and a separation between the outer linear elastic problem and the inner damage crack tip problem can be achieved. The curve at $r=0.5D$ is situated a little above the theoretic prediction, hence the $r$-dependence and the $\theta$-dependence of the stress tensor is no longer decoupled compared to the linear elastic prediction \eqref{eq:singularform}. It can be verified that the stress is indeed maximal in front of the crack tip at $\theta=0$.
\end{itemize}

At the onset of microbranching $t\approx t_\mc$, two arbitrary but close instants near point $B$ in \cref{fig:plate-v} are chosen and the normalized hoop stress distribution is indicated in \cref{fig:SigMB}.
\begin{figure}[htbp]
\centering
\includegraphics[width=\linewidth]{SigMB.pdf}
\caption{Normalized hoop stress distribution at the onset of micro-branching: (a) $\dot{l}_t\approx 0.36c_\mathrm{R}$ and (b) $\dot{l}_t\approx 0.43c_\mathrm{R}$} \label{fig:SigMB}
\end{figure}
Compared to situation at point $A$, several qualitative behaviors of the stress distribution near the crack tip are noteworthy. Using the angular variation at $r=D$, a slight mode-II perturbation $\widehat{K}_\RNN{2}\approx 0.09$ is detected at the onset of microbranching, \emph{i.e.} a loss of symmetry. The existence of such perturbations may be due to structural effects and has already been observed in dynamic fracture experiments, see \cite{BoueCohenFineberg:2015}. A mode-II component in the stress tensor contributes to the crack branching instability, but it is not taken into account in many theoretic approaches to crack branching. From \cref{fig:SigMB}, we observe that the maximum of the normalized hoop stress begins to deviate from the propagation direction $\theta=0$, especially for the curve $r=0.5D$. This indicates that the microbranching phenomenon satisfies a generalized Yoffe's criterion, since in gradient damage models the angular variation depends also on the distance $r$ to the crack. Such criterion should be only considered as a necessary condition of crack branching. However it could be used to indicate a possible crack branching event. Only mode-I asymptotic expansions are considered in the original Yoffe's criterion, which leads to a higher branching speed $v_\mc\approx 0.6c_\mathrm{R}$. According to \cref{fig:SigMB}, this critical velocity can be reduced by including a mode-II perturbation.

\subsection*{Conclusion}
The dynamic gradient damage model could be computationally more demanding compared to traditional approaches based on a sharp description of cracks. Griffith's law combined with specialized numerical methods could perform reasonably well with much less computational cost for fracture problems in the absence of crack nucleation and complex topology changes. The major advantage of phase-field modeling reside in its generality in treating 2d and 3d crack evolution problems by providing a unified framework from onset to structural failure. Thanks to an efficient parallelization of the solving algorithm (\cref{algo:explicit}), the computing time can also be significantly reduced as demonstrated in \cref{fig:scaling}.

Two particular damage constitutive laws \eqref{eq:at2} and \eqref{eq:at1} are compared both from a computational and physical point of view. On one hand, the widely used crack surface density function \eqref{eq:at2} is less suitable to model brittle fracture since an elastic domain is absent. On the other hand the actual solving of the damage minimization problem \eqref{eq:crackstdis} is more costly than the damage constitutive law \eqref{eq:at1} which possesses an optimal damage profile of finite band. It is also illustrated that the cost of a general quadratic bound-constrained minimization solver (GPCG) is acceptable.

Finally a better understanding of crack branching predicted by the dynamic gradient damage model is provided. The nucleation of micro-cracks and their subsequent interaction with the main crack is macroscopically identified by a widening of the damage profile perpendicular to the gradient-damage crack. Through numerical simulations, a critical velocity $v_\mc\approx 0.4c_\mathrm{R}$ is detected above which micro-branching events take place, which implies an over-dissipation of energy as the main crack propagates. This critical velocity agrees with the experimental findings and gives a better prediction compared to other theoretical approaches based on a sharp-interface description of cracks which neglects the nonlinear fracture process zone near the crack tip.

Before microbranching, the stress distribution agrees well with the Griffith's theory especially outside the damage process zone with a pure mode-I contribution. However at the onset of microbranching, a mode-II component perturbs the stress distribution. It provides a necessary condition toward an explanation of the branching instability reproduced by the dynamic gradient damage model. Future work will be devoted to a thorough theoretic investigation of this point. In particular, the exact role played by the internal length should be analyzed.

\section{Edge-Cracked Plate Under Shearing Impact} \label{sec:kalthoff}
We consider in this section a pre-notched two-dimensional plane strain plate impacted by a projectile. In the dynamic fracture community this is often referred as the Kalthoff-Winkler experiment reported by \emph{e.g.} \cite{Kalthoff:2000} where a failure mode transition from brittle to ductile fracture is observed for a high strength maraging steel when the impact velocity is increased. The objective here is to investigate the use of several tension-compression asymmetry formulations analyzed in \cref{sec:TC} in a dynamic brittle fracture problem. In particular, the widely used elastic energy density split proposed in \cite{MieheHofackerWelschinger:2010} among the phase-field community will be compared with other models. Furthermore, some dynamic fracture phenomena reproduced by the gradient damage model are also presented. The thematic subjects covered here are thus summarized in \cref{tab:summkalthoff}.
\begin{table}[htbp]
\centering
\caption{Thematic subjects covered in this section} \label{tab:summkalthoff}
\begin{tabular}{ccccc} \toprule
& Going dynamical & $\alpha\leftrightarrow\phi$ & $\nabla\alpha\to\Gamma$ & Experimental validation \\ \midrule
Theoretics & & & & \\
Numerics & & \rightthumbsup & \rightthumbsup & \rightthumbsup \\ \bottomrule
\end{tabular}
\end{table}

\paragraph{Problem setting} Due to symmetry, only the upper half part of the plate will be considered. The geometry and the boundary conditions for the reduced problem are described in \cref{fig:kalthoff}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.45\linewidth]{kalthoff.pdf}
\caption{Geometry and boundary conditions for the edge-cracked plate under shearing impact problem. Damage field $\alpha_t$ at $t=\SI{8e-5}{s}$ ranging from 0 (gray) to 1 (white)} \label{fig:kalthoff}
\end{figure}
As in \cite{BordenVerhooselScottHughesLandis:2012,HofackerMiehe:2012}, the projectile impact is modeled by a prescribed velocity with an initial rise time of \SI{1e-6}{s} to avoid velocity shocks. The material parameters are borrowed from \cite{BordenVerhooselScottHughesLandis:2012} except that the internal length $\eta$ is set to $\SI{0.2}{mm}$. An unstructured and uniform triangular mesh with $h\approx \SI{0.1}{mm}$ is used, arriving at approximately 3 million elements. The explicit time-stepping (\cref{algo:explicit}) implemented in the EPX software is adopted. The current time increment is again calculated based on the CFL condition with a security factor of 0.8. Due to a lower computational cost and a more brittle material behavior, the damage constitutive law \eqref{eq:at1} is used for this simulation.

As a reference, we use the elastic energy split proposed in \cite{FreddiRoyer-Carfagni:2010} where the positive semidefinite part of the total strain will contribute to damage. The initial crack is introduced via a real notch in the geometry. A similar strong scaling curve as \cref{fig:scaling} is obtained with up to 16 cores, see \cref{fig:kalscaling}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\linewidth]{kalthoff_scaling.pdf}
\caption{Strong scaling results for the Kalthoff problem with 3 million elements} \label{fig:kalscaling}
\end{figure}
Due to the additional spectral decomposition, the ``damage assembly'' phase represents now approximately 50\% of the total computational time while the ``damage solving'' still accounts for only 10\%. The actual computation of the eigenvalues and eigenvectors of a $3\times 3$ symmetric matrix is described in \cref{sec:implementation}. The energy evolution obtained by varying the number of processors is indicated in \cref{fig:kalenergy}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\linewidth]{kalthoff_energies_NP.pdf}
\caption{Energy evolution obtained by varying the number of processors} \label{fig:kalenergy}
\end{figure}
Similar to \cref{sec:branching}, small differences can be observed between these parallel computations in terms of global energy evolution, which may be again due to floating point arithmetic and different setting of preconditioners. With an imposed impact speed $v=\SI{16.5}{m/s}$, the damage field $\alpha_t$ at $t=\SI{8e-5}{s}$ produced by the EPX software is depicted in \cref{fig:kalthoff}. The initial (\SI{73}{\degree}) and average (\SI{64}{\degree}) propagation angles are in good agreement with the experimental results and other phase-field simulations \cite{BordenVerhooselScottHughesLandis:2012,HofackerMiehe:2012} based on the damage constitutive law \eqref{eq:at2} and the tension-compression asymmetry formulation proposed by \cite{MieheHofackerWelschinger:2010}.

\subsection{Gradient-damage modeling of dynamic fracture}
If the initial crack $\Gamma_0$ is modeled via an initial damage field $\alpha^{-1}$, as for the previous dynamic crack branching example, no crack propagation is observed and the structures behaves as if the crack does not exist, \emph{i.e.} the crack closure phenomenon. The horizontal displacement $u_x$ obtained in both cases at $t\approx\SI{2.4e-5}{s}$ when the real notch case starts to propagate is presented in \cref{fig:alpha0}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.9\textwidth]{alpha0.pdf}
\caption{Displacement $u_x$ ranging from \SI{0}{mm} (blue) to \SI{0.4}{mm} (red) for (a) the real notch induced initial crack and (b) the damage induced initial crack, at $t\approx\SI{2.4e-5}{s}$ when the crack starts to propagate in the real notch case (a)} \label{fig:alpha0}
\end{figure}
In the real notch induced initial crack case, \emph{contact condition is not prescribed} on the initial crack lips distanced by a finite height $\approx h$ in the geometry. As can be checked from \cref{fig:alpha0}, no material interpenetration happens in the real notch case and waves propagate in the plate through the lower impacted edge. However in the damage induced initial crack case, possible normal compressive stresses can indeed be transferred to the upper part of the plate, via the tension-compression asymmetry model \cite{FreddiRoyer-Carfagni:2010} which simulates a crack closure. Nevertheless, our simulation illustrates that this model also prohibits tangential relative movement along the crack lips, and a \emph{perfect adhesion} (no-slip condition) is observed, \emph{i.e.} exactly the opposite situation compared to the real notch case. This result is expected from our discussions on future improvement of these tension-compression formulations in \cref{sec:howtochoose}. The failure of these elastic energy decompositions to account for the actual damage value or its gradient approximating the crack normal has been reported by \cite{MayVignolletBorst:2015,Strobl:2015aa}. In the subsequent discussions we will only consider the case where the initial crack is introduced via a real notch in the geometry.

The numerically obtained damage profile on a cross-section in the reference configuration parallel to the crack normal is compared to the theoretical one \eqref{eq:at1alpha}. From \cref{fig:damageprofile}, it can be observed that the numerical damage profile is wider than the analytical prediction by approximately $h=\SI{0.1}{mm}$. This phenomena leads to the definition of a numerically amplified effective fracture toughness $(\gc)_\mathrm{eff}$, see \eqref{eq:gceff}, which in this example is given by $(\gc)_\mathrm{eff}=\bigl(1+3h/(8\eta)\bigr)\gc$ corresponding to the constitutive law \eqref{eq:at1} adapted from \cite{HossainHsuehBourdinBhattachary:2014}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\linewidth]{kalthoff_alpha.pdf}
\caption{Damage profile perpendicular to the crack} \label{fig:damageprofile}
\end{figure}

Assuming that micro-branching does not take place, from the $\Gamma$-convergence result the crack length $l_t$ can be estimated by \eqref{eq:gammaconvergence}. A 2nd-order difference scheme is then used to calculate the crack velocity. The temporal evolution of the crack length and the velocity is indicated in \cref{fig:crack_length_speed}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.55\linewidth]{kalthoff_length_speed.pdf}
\caption{Crack length and velocity obtained for the edge-cracked plate with an imposed impact speed $v=\SI{16.5}{m/s}$} \label{fig:crack_length_speed}
\end{figure}
As can be seen from \cref{fig:crack_length_speed}, the crack speed is well bounded by the Rayleigh wave speed (here $0.7c_\mathrm{R}$), the theoretical limiting speed for an in-plane crack. It should be noted that this upper bound is rooted in the stability condition \eqref{eq:vi} and the energy balance \eqref{eq:dyngdeb}, contrary to the thick level set approach \cite{MoreauMoesPicartStainier:2015} where this limiting speed is considered as an additional modeling parameter. The crack length is approximately \SI{90}{mm} at $t=\SI{8e-5}{s}$ when the crack is about to reach the boundary, cf. \cref{fig:kalthoff}. This estimation agrees fairly well with a direct calculation based on a straight crack propagating at \SI{64}{\degree}, which gives about \SI{83}{mm}. We believe that the discrepancy on crack length as well as a smaller limiting speed for brittle materials reported in experiments can be attributed to the dynamic instability mechanism reviewed in \cite{FinebergMarder:1999} and discussed in this work in \cref{sec:microbrachingstu}. As the crack speed approaches a critical speed approximately $0.4c_\mathrm{R}$, micro-branches appear along the main crack and hence more energy is dissipated during propagation. In that case \eqref{eq:gammaconvergence} is no longer valid and the apparent fracture toughness should be adapted to be velocity-dependent. With the \eqref{eq:at2} constitutive law, authors of \cite{BordenVerhooselScottHughesLandis:2012,VignolletMayBorstVerhoosel:2014} report a systematic overestimation of the damage dissipation energy with \eqref{eq:gammaconvergence}. Following our discussion in \cref{sec:branching}, it could be mainly due to the absence of a purely elastic domain and the fact that damage evolves even in the stress-hardening phase. However in the definition of the fracture toughness, this phenomena is not taken into account, see \cite{BourdinFrancfortMarigo:2008}.

\subsection{Velocity effect and use of different tension-compression models}
When the prescribed impact velocity is increased from $v=\SI{16.5}{m/s}$ to $v=\SI{100}{m/s}$, successive crack branching and nucleation of cracks at the lower-right corner due to high tensile stresses are observed as can be seen from \cref{fig:v1d5}. The hydrostatic stress $p_t=\frac{1}{2}\tr\sig_t$ is presented in the deformed configuration and we verify that no damage is produced in the compression zones. To visualize the crack, elements with $\alpha_t>0.9$ are hidden in the graphical output. Similar phenomena have been reported in \cite{HofackerMiehe:2012} with $v=\SI{50}{m/s}$. Recall that in the Kalthoff-Winkler experiment a failure-mode transition from mode-\RNN{1} to mode-\RNN{2} is observed when the impact velocity increases. The discrepancy between our simulation and the experiment is due to the material constitutive behavior. As a material parameter, the tension-compression formulation of \cite{FreddiRoyer-Carfagni:2010} coupled with a purely elastic model favors propagation of mode-\RNN{1} cracks in the direction perpendicular to the maximal principle stress. On the contrary, the high strength steel used in the experiment develops a considerable plastic zone along the mode-\RNN{2} crack and an elastic-plastic-damage model should be more suitable, see for example the work of \cite{MieheHofackerSchaenzelAldakheel:2015}. Nevertheless, experimentally more bifurcations are indeed observed for brittle materials such as glass when the impact velocity is increased, which is known as a \emph{velocity effect} in \cite{Schardin:2012}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.9\textwidth]{kalthoff_TC6.pdf}
\caption{Simulation results at $t=\SI{4e-5}{s}$ with an impact speed $v=\SI{100}{m/s}$: (a) the damage field $\alpha_t$ ranging from 0 (blue) to 1 (red), and (b) the hydrostatic stress $\frac{1}{2}\tr\sig_t$ ranging from less than \SI{-1e4}{MPa} (blue) to more than \SI{1.5e3}{MPa} (red). The tension-compression asymmetry model \cite{FreddiRoyer-Carfagni:2010} is used} \label{fig:v1d5}
\end{figure}

On the other hand, the widely used elastic energy density split proposed in \cite{MieheHofackerWelschinger:2010} produces diffusive damage in compression zones. From \cref{fig:v1d5_miehe}, we observe appearance of damage at the lower-left corner and at the lower surface of the initial crack edge, even though they are both under compression. This phenomena is conforming to our previous theoretical analysis of this model on a homogeneous uniaxial compression experiment in \cref{sec:uniaxial}, where it is found that damage grows even though the compressive stress is still increasing in its absolute value.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.9\textwidth]{kalthoff_TC5.pdf}
\caption{Simulation results at $t=\SI{4e-5}{s}$ with an impact speed $v=\SI{100}{m/s}$: (a) the damage field $\alpha_t$ ranging from 0 (blue) to 1 (red), and (b) the hydrostatic stress $\frac{1}{2}\tr\sig_t$ ranging from less than \SI{-1e4}{MPa} (blue) to more than \SI{1.5e3}{MPa} (red). The tension-compression asymmetry model \cite{MieheHofackerWelschinger:2010} is used} \label{fig:v1d5_miehe}
\end{figure}

The tension-compression split based on the trace of the total strain \cite{AmorMarigoMaurini:2009} is also tested. In \cite{LancioniRoyer-Carfagni:2009}, the pure compression version of this model is used to simulate shear cracking behavior in the stone ashlars. In this dynamic impact problem, we also observe at $t\approx\SI{7e-6}{s}$ appearance of mode-\RNN{2} cracks originating from the impacted-edge, see \cref{fig:TC2}. We conclude that the tension-compression split \eqref{eq:elasticTC} could indeed be considered as a material parameter as it represents the fracture mechanism determined by the microstructure and leads to different macroscopic fracture patterns. Note however that the calculation suddenly stops after that time due to an extremely small CFL time step $\Delta t_\mathrm{CFL}=h/c$, which is caused by a highly distorted element $h\to 0$ in the explicit dynamics context. The same numerical issue has been reported by \cite{PieroLancioniMarch:2007} in which an Ogen hyperelastic model is used. Remark that the use of a tension-compression split based on the positive eigenvalues of the strain, \emph{i.e.} that of \cite{MieheHofackerWelschinger:2010,FreddiRoyer-Carfagni:2010}, actually circumvents this problem by revising the material constitutive behavior.
\begin{figure}[htbp]
\centering
\includegraphics[height=5cm]{TC2_v1d5_alpha.png}
\caption{Damage field at $t\approx\SI{7e-6}{s}$ obtained for the edge-cracked plate with an imposed impact speed $v=\SI{100}{m/s}$. The elastic energy split \cite{AmorMarigoMaurini:2009} is used} \label{fig:TC2}
\end{figure}

\subsection*{Conclusion}
Different tension-compression asymmetry formulations in \cref{sec:TC} are analyzed numerically here. Some physical properties derived through a uniaxial traction experiment are verified in actual dynamic fracture problems. The elastic energy split proposed by \cite{FreddiRoyer-Carfagni:2010} is recommended for brittle materials because homogeneous (diffusive) damage does not occur under compression. However these models should be modified to correctly account for the unilateral contact condition. A better strategy may be to use a transition algorithm between the smeared and the sharp-interface description of cracks. To successfully model the transition from mode-I to mode-II, one may need to couple a plasticity model with the current dynamic gradient damage model.

\section{Crack Arrest Due to the Presence of a Hole} \label{sec:gregoire}
This section is devoted to a two-dimensional experimental validation of the dynamic gradient damage model for brittle materials. The thematic subjects covered here are thus summarized in \cref{tab:summhole}.
\begin{table}[htbp]
\centering
\caption{Thematic subjects covered in this section} \label{tab:summhole}
\begin{tabular}{ccccc} \toprule
& Going dynamical & $\alpha\leftrightarrow\phi$ & $\nabla\alpha\to\Gamma$ & Experimental validation \\ \midrule
Theoretics & & & & \\
Numerics & & & & \rightthumbsup \\ \bottomrule
\end{tabular}
\end{table}

\paragraph{Problem setting} The problem considered is the ``one crack two holes'' test studied in \cite{HaboussaGregoireElguedjMaigreCombescure:2011}, where it is found that in dynamics cracks may be pushed away from the holes present in the domain due to wave reflections. The geometry and the boundary conditions are recalled in \cref{fig:gregoire}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.7\linewidth]{gregoire.pdf}
\caption{Geometry and boundary conditions for the ``one crack two holes'' experiment studied in \cite{HaboussaGregoireElguedjMaigreCombescure:2011}. Damage field $\alpha_t$ at $t=\SI{2e-4}{s}$ ranging from 0 (gray) to 1 (white)} \label{fig:gregoire}
\end{figure}
Plane stress condition is assumed. Initial crack is introduced via a real notch in the geometry. The damage constitutive law \eqref{eq:at1} is used again due to its interesting properties discussed in the dynamic crack branching problem. Since PMMA is a brittle material \cite{GregoireMaigreRethoreCombescure:2007} and the model of \cite{MieheHofackerWelschinger:2010} possesses a peculiar behavior under high compression, the tension-compression asymmetry formulation proposed by \cite{FreddiRoyer-Carfagni:2010} is adopted. Materials properties of PMMA, including the density, the dynamic Young's modulus and the Poisson ratio, are borrowed from \cite{HaboussaGregoireElguedjMaigreCombescure:2011}. In their calculations, crack propagation is based on a variant of the Griffith's law where one critical stress intensity factor $K_\mathrm{IC}=\SI{1.03}{MPa\sqrt{m}}$ predicts initiation and another $K_\mathrm{IA}=\SI{0.8}{MPa\sqrt{m}}$ determines crack propagation and arrest. The latter one is used in our calculation as it deals with the most important phase of crack evolution. It is then converted to the fracture toughness
\begin{equation} \label{eq:pmmagc}
\gc=\frac{K_\mathrm{IA}^2}{E}\approx\SI{0.2667}{N/mm}
\end{equation}
thanks to the Irwin's formula under plane stress condition. The material internal length, or equivalently the maximal tensile stress of PMMA through \eqref{eq:sigc0}, is unknown. Two reasonable values are tested corresponding respectively to a critical stress $\SI{70}{MPa}$ or $\SI{80}{MPa}$, which gives along with \eqref{eq:pmmagc} either $\eta\approx\SI{0.05}{mm}$ or $\eta\approx\SI{0.0375}{mm}$. An unconstrained mixed triangular-quadrilateral mesh refined with $h\approx\SI{2e-2}{mm}$ near the initial crack and all possible nucleation sites is used, arriving at approximately \num{400000} elements. The explicit time-stepping (\cref{algo:explicit}) implemented in the EPX software is adopted. The current time increment is updated based on the CFL condition with a security factor of 0.8.

\paragraph{Simulation results and discussion} The simulations results are illustrated in \cref{fig:siggregoire}.
\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{gregoire_7080.pdf}
\caption{Hydrostatic stress $p_t=\frac{1}{2}\tr\sig_t$ ranging from less than \SI{-30}{MPa} (blue) to more than \SI{30}{MPa} (red) for (a) $\sigma_\mathrm{m}=\SI{70}{MPa}$ at $t\approx\SI{1.6e-4}{s}$, and (b) $\sigma_\mathrm{m}=\SI{80}{MPa}$ at $t\approx\SI{1.8e-4}{s}$, in the crack arrest problem} \label{fig:siggregoire}
\end{figure}
In both cases crack arrest is reproduced due to the high compression area under the right circular hole. In the case when the maximal tensile stress is set to $\sigma_\mathrm{m}=\SI{70}{MPa}$, secondary crack nucleation is observed at the right circular hole boundary under high tension. This phenomena is not observed in experiments and hence the critical stress value of $\sigma_\mathrm{m}=\SI{70}{MPa}$ is thus underestimated. In the $\sigma_\mathrm{m}=\SI{80}{MPa}$ case, no secondary crack nucleation is found. This result again highlights the role played by the internal length $\ell$ as a material parameter.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\linewidth]{gregoire_cracktip.pdf}
\caption{Crack tip abscissa evolution in the crack arrest problem. Comparison between the $\sigma_\mathrm{m}=\SI{80}{MPa}$ case and the experimental results} \label{fig:cracktip}
\end{figure}

As the crack front is not explicitly tracked in phase-field modeling of fracture, here the current crack tip is located on the contour $\alpha=0.9$ at the farthest point in the $x$-direction. We then compare the numerical crack tip abscissa evolution with the experimental one \cite{HaboussaGregoireElguedjMaigreCombescure:2011}, in \cref{fig:cracktip}. Very good agreement can be found in the crack initiation and propagation phase. The crack arrest predicted is slightly conservative compared to the experimental one. This could be due to the small deviation of the initial crack from the symmetry axis in the experiment \cite{HaboussaGregoireElguedjMaigreCombescure:2011}. Meanwhile the maximal tensile stress $\sigma_\mathrm{m}\geq\SI{80}{MPa}$ could be considered as an adjusting parameter of the model. More simulations could be performed to determine its best value, at a price of using a more refined mesh since $\ell\propto1/\sigma_\mathrm{m}^2$ according to \eqref{eq:sigc0}.

\paragraph{Conclusion} The dynamic gradient damage model outlined in \cref{def:dynagraddama} along with the \eqref{eq:at1} damage constitutive law and the tension-compression model of \cite{FreddiRoyer-Carfagni:2010} is experimentally validated for PMMA specimens. Further studies will focus on applications to concrete structures.

\section{Brazilian Splitting Test on Concrete Cylinders} \label{sec:brazilian}
This section is devoted to three-dimensional numerical simulations of the Brazilian tests on concrete cylinders. Due to an increasing compressive load applied along the diameter direction, eventually fracture takes place along the loading direction and the cylinder splits vertically into two parts. One objective here is to verify the EPX implementation of the explicit time-stepping procedure summarized in \cref{algo:explicit} during a three-dimensional calculation. Furthermore, different tension-compression asymmetry formulations analyzed in \cref{sec:TC} are compared with respect to their aptitude to reproduce such fracture pattern. The size effect reported by various authors such as \cite{RoccoGuineaPlanasElices:1999,RuizOrtizPandolfi:2000} is also investigated using the dynamic gradient damage model. The thematic subjects covered here are thus summarized in \cref{tab:summbrazilian}.
\begin{table}[htbp]
\centering
\caption{Thematic subjects covered in this section} \label{tab:summbrazilian}
\begin{tabular}{ccccc} \toprule
& Going dynamical & $\alpha\leftrightarrow\phi$ & $\nabla\alpha\to\Gamma$ & Experimental validation \\ \midrule
Theoretics & & & & \\
Numerics & & \rightthumbsup & \rightthumbsup & \rightthumbsup \\ \bottomrule
\end{tabular}
\end{table}

\paragraph{Problem setting} The geometry and loading conditions are summarized in \cref{fig:brazilian}. Two diameters will be considered here to investigate possible size effects: $D=\SI{500}{mm}$ and $D=\SI{200}{mm}$. The bearing strips are introduced to prevent ill-posed concentration. In this work they are assumed to be a part of the cylinder for the sake of simplicity, however more realistic modeling involving unilateral contact conditions is possible. The compressive loads are prescribed by a given velocity evolution $\vec{V}_t$ on the outer surface of the strips. In this work the dynamic effect is not the main objective and hence a relatively low loading velocity is used $\norm{\vec{V}_t}=\SI{\pm 0.1}{m/s}$. An initial rise time of \SI{1e-6}{s} is introduced to avoid velocity shocks.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.4\textwidth]{brazilian.pdf}
\caption{Three-dimensional Brazilian test on a concrete cylinder characterized by its diameter $D$ and its height $W$. The compressive loads modeled as prescribed velocities are transmitted to the cylinder along the vertical diameter direction via two bearing strips of width $D/16$} \label{fig:brazilian}
\end{figure}
The material parameters for a typical concrete are borrowed from \cite{RuizOrtizPandolfi:2000}. Numerically an unstructured tetrahedral mesh is used to discretize the cylinder volume. A uniform mesh size of $h\approx\SI{10}{mm}$ leads to approximately \num{1e5} finite elements for $D=\SI{500}{mm}$ and \num{25000} elements for the small cylinder with $D=\SI{200}{mm}$. The material and numerical parameters are summarized in \cref{tab:brazilian}. The damage constitutive law \eqref{eq:at1} is used. Using the identification of the equivalent fracture toughness \eqref{eq:gcingd}, the internal length $\eta$ can be derived from $\gc$ and $\sigma_\mc$, which gives $\eta\approx \SI{46}{mm}$.
\begin{table}[htbp]
\centering
\caption{Material and numerical parameters for the Brazilian test} \label{tab:brazilian}
\begin{tabular}{llllll} \toprule
$\rho$ & $E$ & $\nu$ & $\gc$ & $\sigma_\mc$ & $h$ \\ \midrule
\SI{2450}{kg/m^3} & \SI{37.9}{GPa} & 0.15 & \SI{66.2}{N/m} & \SI{4.53}{MPa} & \SI{10}{mm} \\ \bottomrule
\end{tabular}
\end{table}

\subsection{Fracture pattern predicted by different tension-compression models}
Pursuing the work of \cref{sec:kalthoff}, the use of different tension-compression asymmetry formulations as discussed in \cref{sec:TC} are investigated here with respect to their aptitude to reproduce the desired vertical splitting fracture pattern of the cylinder. As a genuine material parameter, the choice of these formulations in a numerical simulation should be justified by experimental facts on the specific material. In this work two particular models are compared: the approach proposed by \cite{AmorMarigoMaurini:2009} by separating the deviatoric and spheric part of the sound elastic energy and the model proposed by \cite{FreddiRoyer-Carfagni:2010} which is recommended following our analyses in \cref{sec:kalthoff}. The big cylinder with $D=\SI{500}{mm}$ is first used. The final fracture pattern obtained by these two formulations is indicated in \cref{fig:brazilian_tc}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.9\textwidth]{brazilian_TC.pdf}
\caption{Fracture pattern represented by the damage field ranging from 0 (blue) to 1 (red) for the Brazilian splitting test obtained by two tension-compression asymmetry models: (a) the model of \cite{AmorMarigoMaurini:2009} and (b) the model of \cite{FreddiRoyer-Carfagni:2010}} \label{fig:brazilian_tc}
\end{figure}
Several remarks are given as follows.
\begin{itemize}
\item With the model proposed by \cite{AmorMarigoMaurini:2009}, damage is concentrated where the loads are applied. This experiment illustrates its deficiency to describe the microscopic/macroscopic fracture mechanism of concrete.

\item Vertical splitting is reproduced by the formulation of \cite{FreddiRoyer-Carfagni:2010}. It illustrates that the damage mechanism in concrete is indeed induced by local tensile stresses. It can be seen that fracture is homogeneous in the height $W$ direction. A two-dimensional modeling could suffice. In this work the obtained three-dimensional simulation results verify the generality of the variational formulation outlined in \cref{def:dynagraddama} and the robustness of the EPX implementation described in \cref{sec:epx}.
\end{itemize}

\subsection{Temporal evolution of global quantities and fields}
The evolution of global quantities and fields is now investigated. A useful reference time scale $t_\mathrm{ref}=D/c$, which corresponds to the time for the elastic wave to travel across the cylinder diameter, is used to normalize the time variable. First, we are interested in the temporal evolution of the applied vertical load $F_t$ transmitted through the bearing strip. From basic static elastic analyses, the load $F_t$ induces a maximum splitting tensile stress $\sigma$ at the center of the diameter which is given by
\begin{equation} \label{eq:sigmaFWD}
\sigma=\frac{2F}{\pi WD}
\end{equation}
According to the damage criterion \eqref{eq:localdamagefirstorder} for an initially sound body (as analyzed in \cref{sec:1d}), damage or fracture is expected to take place at the center where the criterion is firstly satisfied. A critical load $F_\mathrm{ref}$ which corresponds to the critical stress $\sigma_\mc$ in \eqref{eq:sigmaFWD} can thus be defined. It is used for normalization. The evolution for $t\mapsto F_t$ is illustrated in \cref{fig:brazilian_ft}. Some snapshots of the damage field at some particular instants are taken to complement the curve.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\textwidth]{brazilian-ft.pdf}
\caption{Temporal evolution of the applied load transmitted through the bearing strip with or without activation of the erosion mechanism available in the EPX software, illustrated by snapshots of the damage field ranging from 0 (blue) to 1 (red)} \label{fig:brazilian_ft}
\end{figure}

The curve labeled ``Without erosion'' is first analyzed. It can be verified that damage begins to evolve at the center when the splitting stress induced by the transmitted load $F_t$ attains the material critical stress. As $F_t$ increases, damage develops and propagates into a crack band along the vertical diameter direction until a complete split of the cylinder. However the temporal evolution of $F_t$ requires further investigation:
\begin{itemize}
\item The applied load attains a peak of approximately $1.2F_\mathrm{ref}$, which may due to structural hardening effects between the damage initiation when $F_t\approx F_\mathrm{ref}$ and the onset of fracture.

\item After the peak, unexpectedly the load is not instantaneously decreasing to zero. However, its temporal evolution indicates that there exists still some residual stiffness along the vertical crack. Remark that the loading condition is very similar to the edge-cracked plate experiment studied in \cref{sec:kalthoff}, \emph{i.e.} sliding loads parallel to an existing or established gradient-damage crack. Continuing our analyses there, it is suspected that this peculiar temporal evolution is again due to the deficiency of the existing tension-compression models to represent a genuine unilateral condition, see \cref{sec:howtochoose}. In particular, the crack normal direction is not considered in these models, hence some residual stresses may be present parallel to the crack. The definition of such normal vectors, nevertheless, is not trivial due to the smeared description. We reiterate the conclusion of \cref{sec:kalthoff} that a better strategy may be to use a transition algorithm between the smeared and the sharp-interface description of cracks.

\item A possible remedy within the EPX environment may be to activate the ``erosion'' mechanism. When a crack is detected (for example when the effective degradation \eqref{eq:aeff} approaches zero within a tolerance) for a certain finite element, its contribution to the internal force vector \eqref{eq:Fint} will be ignored. By doing so, an approximative stress-free condition is thus by default prescribed along the crack lip. With the activation of the erosion mechanism, the fracture pattern is not altered however as can be seen from \cref{fig:brazilian_ft}, the transmitted load quickly decreases to zero after the peak value, which corresponds to ultimate structural failure. Future work will be devoted to a thorough investigation of the erosion mechanism to take into account for instance unilateral effects.
\end{itemize}

Temporal evolution of global energetic quantities is illustrated in \cref{fig:brazilian_e}. It can be seen that initially inertia is not important which in turn ensures the validity of \eqref{eq:sigmaFWD}. During crack nucleation and propagation along the diameter, the kinetic energy suddenly develops and becomes comparable to the elastic energy, which illustrates the unstable or brutal nature of the crack propagation phase. A full dynamic analysis is indeed more appropriate for this Brazilian test.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\textwidth]{brazilian-energy.pdf}
\caption{Temporal evolution of global energetic quantities with the erosion mechanism} \label{fig:brazilian_e}
\end{figure}

\subsection{Size effect}
A size effect is present for the present Brazilian test following the analyses in \cite{RoccoGuineaPlanasElices:1999,RuizOrtizPandolfi:2000}. In particular, smaller cylinders should produce higher peak loads (normalized by $F_\mathrm{ref}$ determined by the material critical stress and the diameter) at the onset of fracture, confirming the commonly acknowledged idea \emph{smaller is stronger}. On the other hand, bigger cylinders should break as soon as the critical material stress is reached. The temporal evolution of the applied load $F_t$ for two concrete cylinders with different diameters are indicated in \cref{fig:brazilian_size}. It can be seen that the fracture pattern remains similar. The above size effect is numerically verified and reproduced by the dynamic gradient damage model. The existence of such size effects is due to the introduction of the material internal length $\ell$, see also the work on crack nucleation of a bar in \cref{sec:1d}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\textwidth]{brazilian-size.pdf}
\caption{Temporal evolution of the applied load transmitted through the bearing strip for two concrete cylinders with different diameters} \label{fig:brazilian_size}
\end{figure}

\subsection*{Conclusion}
In terms of fracture pattern prediction for concrete structures, the tension-compression model proposed by \cite{FreddiRoyer-Carfagni:2010} seems to be a good candidate compared to other choices. However the crack normal vector is not taken into account and residual stiffness may be present along and parallel to the crack lip. The ``erosion'' mechanism available in the EPX software could produce a real crack however its use need further investigation. Size effect for Brazilian tests on concrete cylinders is reproduced by the gradient damage model. The existence of such experimentally validated size effects is due to the introduction of the material internal length $\ell$.

\section{Dynamic Fracture of L-Shaped Concrete Specimen} \label{sec:L-specimen}
This section is devoted to a gradient-damage modeling of the dynamic tensile test on a two-dimensional plane-strain L-shaped concrete specimen. Compared to \cref{sec:brazilian}, the objective here is to investigate dynamic or velocity effects in dynamic fracture problems on concrete structures, \emph{i.e.} their influence on the temporal evolution of global quantities and spatial crack path. An experimental validation of the model is also considered against the results obtained in \cite{OzboltBedeSharmaMayer:2015}. The thematic subjects covered here are thus summarized in \cref{tab:summL}.
\begin{table}[htbp]
\centering
\caption{Thematic subjects covered in this section} \label{tab:summL}
\begin{tabular}{ccccc} \toprule
& Going dynamical & $\alpha\leftrightarrow\phi$ & $\nabla\alpha\to\Gamma$ & Experimental validation \\ \midrule
Theoretics & & & & \\
Numerics & & & \rightthumbsup & \rightthumbsup \\ \bottomrule
\end{tabular}
\end{table}

\paragraph{Problem setting}
The geometry and loading conditions are adapted from \cite{OzboltBedeSharmaMayer:2015} and are summarized in \cref{fig:L-specimen}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.45\linewidth]{L-specimen.pdf}
\caption{Geometry and loading conditions for the L-specimen problem. Damage field $\alpha_t$ at $t=\SI{6e-4}{s}$ ranging from 0 (gray) to 1 (white) obtained by $\eta=\SI{1}{mm}$, for $v=\SI{0.74}{m/s}$} \label{fig:L-specimen}
\end{figure}
A hard device (displacement control) is applied on the lower left arm \SI{30}{mm} from the edge through a disc of $D=\SI{45}{mm}$ to avoid local concentration. The load is applied through unilateral contact (EPX keyword \texttt{IMPACT}) with an imposed velocity $\vec{V}(t)=\overline{V}f(t)\vec{e}_2$. The intensity is scaled via the factor $\overline{V}$. The function $f(t)$ defined below ensures that at crack initiation the loading velocity is approximately $V$:
\begin{lstlisting}
FONC 1 TABL 5 0D0 0D0 1.5D-4 1D0 2D-4 1D0 4D-4 2D0 1D0 2D0.
\end{lstlisting}
The concrete material properties are borrowed from \cite{OzboltBedeSharmaMayer:2015} and are summarized in \cref{tab:L}. The damage constitutive law \eqref{eq:at1} is used. Using \eqref{eq:gcingd}, the internal length $\eta$ can be derived from $\gc$ and $\sigma_\mc$, which gives $\eta\approx \SI{72}{mm}$. The analysis is performed in the temporal interval $[0,\SI{6e-4}{s}]$ and the explicit time-stepping method (\cref{algo:explicit}) is used. According to the comparative analyses in \cref{sec:kalthoff,sec:brazilian}, the tension-compression model proposed by \cite{FreddiRoyer-Carfagni:2010} should be preferred for brittle materials. The domain is discretized by a non-structured quadrilateral mesh with a typical size $h\approx\SI{10}{mm}$, arriving at approximately \num{2000} elements. 
\begin{table}[htbp]
\centering
\caption{Material and numerical parameters for the L-specimen test} \label{tab:L}
\begin{tabular}{llllll} \toprule
$\rho$ & $E$ & $\nu$ & $\gc$ & $\sigma_\mc$ & $h$ \\ \midrule
\SI{2210}{kg/m^3} & \SI{32.2}{GPa} & 0.18 & \SI{58.56}{N/m} & \SI{3.12}{MPa} & \SI{10}{mm} \\ \bottomrule
\end{tabular}
\end{table}

\subsection{Path prediction}
The internal length here $\eta\approx \SI{72}{mm}$ is not small by comparison with the dimension of the body (with a side length $\SI{250}{mm}$). We had the same situation for the Brazilian test in \cref{sec:brazilian} with $D=\SI{200}{mm}$. However in \cref{sec:brazilian} due to symmetry crack nucleates and propagates along the central diameter direction away from the boundary. Furthermore dynamic effects are not important and diffuse damage is not observed. In this problem however, crack path prediction is one of the objectives of the simulation and a large internal length, which implies a large damage band and a more smeared description of cracks, may complicate the identification of the crack path.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.9\textwidth]{v740-1200-sigm.pdf}
\caption{Damage field $\alpha_t$ ranging from 0 (blue) to 1 (red) for two different loading speeds obtained with $\ell\approx\SI{72}{mm}$: (a) $v=\SI{0.74}{m/s}$ and (b) $v=\SI{1.2}{m/s}$} \label{fig:v7401200sigm}
\end{figure}

In \cref{fig:v7401200sigm} the final damage field obtained with $\eta\approx\SI{72}{mm}$ for two different loading speeds is indicated. The simulation results are to be compared with the experimental fracture patterns indicated in \cref{fig:v7401200exp}. For a lower loading speed $v=\SI{0.74}{m/s}$, the initial nucleation angle is close to the experimental one. However the damage field simulated seems to indicate a crack branching event which is not observed in the experiment. For a higher loading speed $v=\SI{1.2}{m/s}$, a relatively large diffusive damage zone is produced near the nucleation corner. The crack branching is reproduced, however the branching location and subsequent crack propagation path do not agree with the experimental results.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.9\textwidth]{v740-1200-exp.pdf}
\caption{Fracture patterns observed in experiments conducted by \cite{OzboltBedeSharmaMayer:2015}} \label{fig:v7401200exp}
\end{figure}

The failure to reproduce the experimentally observed fracture pattern in this example can be partially attributed to the followings difficulties:
\begin{itemize}
\item With a relatively large internal length, the elliptic damage problem interferes with the border $\partial\Omega$ through the boundary condition prescribed in the damage criterion \eqref{eq:localdamagefirstorder} and the consistency condition \eqref{eq:damageconsis}. The value of $\ell$ should be ``reduced'' for smaller structures, see \cite{LorentzGodard:2011}. Furthermore, the separation of scales between the outer fracture mechanics problem and the inner damage strain-softening problem considered in \cref{sec:linkDF,sec:antiplane,sec:kinking} is no longer possible with a large internal length. In that case the gradient damage model can not be considered as an approximation of the \emph{fracture} problem.

\item With the damage constitutive law \eqref{eq:at1} (but also with \eqref{eq:at2}), since no additional parameters are introduced, the internal length is directly computed from \eqref{eq:gcingd} from the fracture toughness and the maximal material stress. For brittle materials such as PMMA considered in \cref{sec:gregoire}, it leads to an extremely small internal length ($\eta\approx\SI{0.0375}{mm}$ is used there) compared to industrial specimen or structures. It calls for a computationally costly numerical simulation with parallel computing techniques, however a confined damage process zone leads to a separation of scales described above and a link between damage and fracture can be achieved. For concrete on the other hand, one obtains with \eqref{eq:gcingd} an internal length of several centimeters. The modeling of fracture phenomena in small concrete specimens with these kind of constitutive laws is questionable.
\end{itemize}

Due to this reason, another series of simulation is performed with $\eta=\SI{1}{mm}$. Using the definition of the maximal stress \eqref{eq:sigc0} and the fracture toughness \eqref{eq:gcingd}, it leads to an overestimation of the maximal tensile strength $\sigma_\mathrm{m}\approx \SI{27}{MPa}$ of the concrete. At a lower loading speed $v=\SI{0.74}{m/s}$, the final fracture pattern indicated by the damage field with $\eta=\SI{1}{mm}$ is illustrated in \cref{fig:L-specimen}. A better agreement between the simulation and the experimental observed crack path is found.

The temporal evolution of the applied force is then analyzed for two different internal lengths. In \cref{fig:F_v740_ell}, it can be observed that the they predict different global structural behaviors only during the post-crack initiation phase. In particular, the peak load is not sensible to the internal length. It could be explained by the presence of the geometric singularity where the damage initiates, which implies that the material critical stress is quickly reached when the waves arrive at the corner.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.5\textwidth]{F_v740_ell.pdf}
\caption{Temporal evolution of the applied force with $v=\SI{0.74}{m/s}$} \label{fig:F_v740_ell}
\end{figure}

\subsection{Dynamical effects}
We then turn to the global dynamic structural response obtained with different loading rates. As it is expected, the peak load increases with the prescribed velocity, cf. \cref{fig:F-v-exp}(a). A good agreement with the experimental measurement is also found at $v=\SI{1.5}{m/s}$ as illustrated in \cref{fig:F-v-exp}(b). Knowing that no strain rates effects is currently taken into account in the material constitutive modeling, this increase of peak load for higher loading rates can be attributed to inertia. According to \cite{OzboltBedeSharmaMayer:2015}, this progressive increase of resistance is a pure consequence of inertial effects and not from velocity-dependent material strength or fracture energy.
\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{F-v-exp.pdf}
\caption{Temporal evolution of the applied force: (a) dynamical effects illustrated by two loading speeds and (b) comparison with experimental measurement at $v=\SI{1.5}{m/s}$} \label{fig:F-v-exp}
\end{figure}

The final crack pattern for $v=\SI{1.5}{m/s}$ is also indicated in \cref{fig:F-v-exp}(b). As it is observed in experiments, crack branching is reproduced. However the crack path corresponds not exactly to what is seen in real concrete specimens. We suspect that it is mainly due to the loading condition which is not described in detail in \cite{OzboltBedeSharmaMayer:2015}. Another possible reason could be the use of a smaller internal length chosen due to the small size of the specimen. Using the true internal length derived from the maximal tensile strength of the concrete, a different branching direction appears to take place in \cref{fig:v7401200sigm}.

\subsection*{Conclusion}
The dynamic gradient damage model is here applied to a relatively small concrete structure with the \eqref{eq:at1} damage constitutive model. Since the internal length deduced from the fracture toughness and the tensile strength is not small compared to the dimension of the body, relatively diffuse damage takes place and the gradient damage model can no longer be considered as a good approximation of brittle fracture. The damage process zone where strain softening dominates is large and the link between damage and fracture outlined in \cref{sec:linkDF} and numerically verified in \cref{sec:antiplane} is not possible. The dynamic gradient damage model does not give a satisfactory prediction of the experimentally observed crack path.

The difficulty resides in the simplicity of the \eqref{eq:at1} damage constitutive model. No additional parameters are introduced and the internal length $\ell$, which determines the damage band, is fixed as long as $\gc$ and $\sigma_\mathrm{m}$ are. Future work will be devoted to the use of more sophisticated constitutive models proposed by \cite{LorentzCuvilliezKazymyrenko:2011,AlessiMarigoVidoli:2015} which introduce additional modeling parameters. Note however that this implies that the minimization problem for the damage variable \eqref{eq:crackmin} is no more quadratic, which leads to a higher computational cost.

\section{CEA Impact Test on Beams} \label{sec:beam}
Finally we propose a preliminary gradient-damage modeling of a three-dimensional reinforced concrete beam under impact. The original experimental campaign is performed in the \emph{laboratoire d'étude de dynamique} (DYN) of CEA Saclay, see for example \cite{Guilbaud:2015} for an overview of the test setting. The objective is to investigate the application of the dynamic gradient damage model to industrial concrete structures with steel reinforcements. The thematic subjects covered here are thus summarized in \cref{tab:summbeam}.
\begin{table}[htbp]
\centering
\caption{Thematic subjects covered in this section} \label{tab:summbeam}
\begin{tabular}{ccccc} \toprule
& Going dynamical & $\alpha\leftrightarrow\phi$ & $\nabla\alpha\to\Gamma$ & Experimental validation \\ \midrule
Theoretics & & & & \\
Numerics & & & & \rightthumbsup \\ \bottomrule
\end{tabular}
\end{table}

\paragraph{Problem setting} The geometric and loading conditions are recalled in \cref{fig:beam}. Due to symmetry, only a quarter $\Omega$ of the reinforced beam is modeled (corresponding to the gray domain in \cref{fig:beam}). The beam is \SI{1.3}{m} long and is subject to a steel projectile with a vertical impact velocity of $v=\SI{8.3}{m/s}$. It is unilaterally supported with a span of \SI{1}{m} both at the upper and lower surface via bearing strips of width \SI{30}{mm}. In this example, the concrete beam is reinforced by two \SI{8}{mm} steel rebars at the top and two \SI{12}{mm} rebars at the bottom. Perfect bonding between these rebars and the concrete beam is assumed. The impact is modeled by a unilateral contact condition between the steel projectile with an initial speed $v$ and the upper surface of the beam. The exact dimensions and other details can be found in \cite{Guilbaud:2015} and references therein. The problem setting described here is also similar to that investigated in \cite{OzboltSharma:2011,AdhikaryLiFujikake:2012}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.9\textwidth]{beam-schema.pdf}
\caption{Geometric and loading conditions for the CEA impact test on beams} \label{fig:beam}
\end{figure}

We now turn to a gradient-damage modeling of the problem. The concrete is governed by a gradient damage material the parameters of which are summarized in \cref{tab:beamconcrete}. Using \eqref{eq:gcingd}, the internal length $\eta$ can be derived from $\gc$ and $\sigma_\mc$, which gives $\eta\approx \SI{60}{mm}$. The rebars obey a typical elasto-plastic law with isotropic hardening for steels. They are considered to be non-damageable in the analysis. Hence the energy minimization principle \eqref{eq:crackmin}, \emph{i.e.} the damage criterion, is now written only for the concrete domain. Due to its appropriate physical properties and a lower computational cost, the damage constitutive law \eqref{eq:at1} is used for this simulation. Similar to previous examples, the tension-compression model proposed by \cite{FreddiRoyer-Carfagni:2010} is preferred to characterize tensile fracture behaviors of brittle materials.
\begin{table}[htbp]
\centering
\caption{Material and numerical parameters for the beam test} \label{tab:beamconcrete}
\begin{tabular}{llllll} \toprule
$\rho$ & $E$ & $\nu$ & $\gc$ & $\sigma_\mc$ & $h$ \\ \midrule
\SI{2300}{kg/m^3} & \SI{25}{GPa} & 0.2 & \SI{57}{N/m} & \SI{3}{MPa} & \SI{5}{mm} \\ \bottomrule
\end{tabular}
\end{table}

Numerically a uniform 8-node hexahedral solid elements are used to discretize the concrete domain with a typical mesh size $h\approx\SI{5}{mm}$, arriving at approximately \num{80000} elements, see \cref{fig:beammesh}. The steel rebars are also discretized with the same solid elements. The explicit time-stepping (\cref{algo:explicit}) implemented in the EPX software is adopted. The current time increment is calculated based on the CFL condition with a security factor of 0.8.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.4\textwidth]{beam-mesh.png}
\caption{8-node hexahedral solid elements used to discretize the concrete domain after symmetry considerations} \label{fig:beammesh}
\end{figure}

\paragraph{With original concrete parameters} Using the material parameters given in \cref{tab:beamconcrete}, it can be observed that while the material internal length $\eta$ is small by comparison to the beam length (about 0.05\%), it still accounts for 30\% of the height. According to the previous analysis in \cref{sec:L-specimen}, it may lead to some modeling difficulties when the crack direction possesses a component parallel to the length direction. The damage field obtained during numerical simulation is illustrated in \cref{fig:beamsigm}.
\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{beam-sigm.pdf}
\caption{Fracture pattern with the parameters indicated in \cref{tab:beamconcrete} at (a) $t=\SI{4e-4}{s}$ and (b) $t=\SI{7e-4}{s}$} \label{fig:beamsigm}
\end{figure}

This numerical result (\cref{fig:beamsigm}) is to be compared with the experimentally observed fracture pattern reported in \cite{Guilbaud:2015}, see \cref{fig:beamexp}. In the experiment, the structural failure is characterized by the nucleation of two main inclined cracks forming a cone at the center of the beam. Several minor vertical cracks are also observed in the shear plug. However here a large diffuse damage region is produced at the center of the beam, which implies that the concrete material is totally disintegrated. Diffuse damage also takes place at the upper surface and near the lower supporting location. Although the central damage region is well delimited by a similar inclined cone, the presence of the diffuse damage compromises the use of gradient damage approaches for an appropriate modeling of brittle fracture. Furthermore, we observe a gradual propagation of the diffuse damage in the beam such that at $t=\SI{7e-4}{s}$ a large region of the beam is totally damaged.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.4\textwidth]{beam-exp.png}
\caption{Experimentally observed fracture pattern corresponding to the formation of a shear plug at the center under the projectile} \label{fig:beamexp}
\end{figure}

\paragraph{Use of a smaller internal length} Similarly to \cref{sec:L-specimen}, we expect that the use of a more sophisticated damage constitutive law that introduces additional parameters could provide a better characterization of brittle behaviors of concrete for relatively small structures. Future work will be devoted to this point. Here we present in the sequel some preliminary results obtained with a smaller internal length. 

We artificially decrease the internal length to $\eta=\SI{10}{mm}$, which amounts to increase the critical stress to $\sigma_\mathrm{m}=\SI{7}{MPa}$. The damage field obtained at $t=\SI{4e-4}{s}$ is illustrated in \cref{fig:beamell0x1}.
\begin{figure}[htbp]
\centering
\includegraphics[width=0.9\textwidth]{beam-ell0x1.png}
\caption{Fracture pattern obtained with $\eta=\SI{10}{mm}$ at $t=\SI{4e-4}{s}$} \label{fig:beamell0x1}
\end{figure}
The formation of two main inclined cracks becomes more apparent. Some minor vertical cracks are also reproduced on the upper surface of the beam, as it is observed in the experiment described in \cite{OzboltSharma:2011}. However diffuse damage still takes place at the center of the beam.

The temporal evolution of certain quantities is analyzed. In particular, we illustrate in \cref{fig:projectileU} the vertical displacement evolution of the projectile. On the one hand, using the standard critical stress $\sigma_\mathrm{m}=\SI{3}{MPa}$ of concrete, we observe progressive descending of the projectile. The resistance of the beam is not strong enough to stop the impactor. On the other hand, when using a larger critical stress obtained with $\eta=\SI{10}{mm}$, the rebound of the projectile is observed after a transient descending phase when structural fracture of the beam takes place. In the experiment reported in \cite{Guilbaud:2015}, the final vertical displacement is stabilized at $u_y\approx \SI{-24}{mm}$. The current gradient-damage modeling fails to give an accurate global evolution prediction.
\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{projectile-U.pdf}
\caption{Vertical displacement of the impactor for two internal lengths: (a) comparison between $\sigma_\mathrm{m}=\SI{3}{MPa}$ and $\eta=\SI{10}{mm}$ ($\sigma_\mathrm{m}\approx \SI{7}{MPa}$) and (b) temporal zoom for $\eta=\SI{10}{mm}$} \label{fig:projectileU}
\end{figure}

If the internal length is further decreased to $\eta=\SI{5}{mm}$ ($\sigma_\mathrm{m}\approx \SI{10}{MPa}$), several shear cracks forming an angle of approximately \SI{45}{\degree} with respect to the $x$-axis are observed under the impactor, see \cref{fig:beamsigmell0x005}(a). For this calculation a more refined mesh with $h=\SI{2.5}{mm}$ is used, arriving at approximately \num{640000} 8-nodes hexahedral elements. This fracture pattern is commonly observed in impact experiments on concrete beams, see \cite{OzboltSharma:2011}. The angle also matches well with the experimental results reported in \cite{Guilbaud:2015}. A diffuse damage region due to high tensile stresses is produced on the lower surface under the projectile.
\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{beam-ell0x005.pdf}
\caption{Fracture pattern obtained with $\eta=\SI{5}{mm}$ at (a) $t=\SI{2e-4}{s}$ and (b) $t=\SI{3e-4}{s}$} \label{fig:beamsigmell0x005}
\end{figure}

As can be seen from \cref{fig:beamsigmell0x005}, secondary cracks appear and then propagate from the upper surface of the beam. This phenomenon is also produced in the numerical study of \cite{AdhikaryLiFujikake:2012}. The biggest eigenvalue of the stress tensor at $t=\SI{1.6e-4}{s}$ is illustrated in \cref{fig:beameig} just before crack nucleation in the beam. The compressive area is localized on the upper surface just under the impactor and is not visible in the figure. We observe tensile stress areas generated by the impactor which correspond to the crack nucleation sites observed in \cref{fig:beamsigmell0x005}. This fracture pattern is thus the result of the tension-compression asymmetry formulation \cite{FreddiRoyer-Carfagni:2010} which favors mode-I cracks induced by positive principal stresses. 
\begin{figure}[htbp]
\centering
\includegraphics[width=\textwidth]{ell0x005-eig.png}
\caption{The biggest eigenvalue of the stress tensor at $t=\SI{1.6e-4}{s}$ ranging from less than \SI{-7}{MPa} (blue) to more than \SI{3}{MPa} (red). The compressive area is localized on the upper surface just under the impactor} \label{fig:beameig}
\end{figure}

Finally we turn to the computational aspect of a parallel 3d calculation with the dynamic gradient damage model. Domain decomposition using 64 processors is performed. The final calculation time is fixed to $t=\SI{4e-4}{s}$ after the structural failure of the beam, see \cref{fig:beamsigmell0x005}. The partition of the total computational time using the convention given in \cref{sec:branching} is given in \cref{tab:partimebeam}. The mean value among all processors is used. Since the damage is a scalar field, the actual solving of the damage problem \eqref{eq:cracknummin} through the GPCG algorithm described in \cref{sec:implementation} still accounts for approximately 10\% of the total computational time as in the 2d cases, see \cref{fig:scaling,fig:kalscaling}. If the communication overhead is ignored, the cost of a gradient-damage constitutive modeling of brittle materials (damage assembly and solving) represents less than 2 times the cost for the $\vec{u}$-problem. The same observation is found for two-dimensional problems. Note however if a more sophisticated damage constitutive law is used, the cost for the damage problem may increase due to variable Hessian matrix.
\begin{table}[htbp]
\centering
\caption{Partition of the total computational time for the CEA impact test on beams with 64 processors} \label{tab:partimebeam}
\begin{tabular}{lllll} \toprule
Total time & Elastodynamics & Damage assembly & Damage solving & Communication \\ \midrule
\SI{39}{mn} & 32\% & 43\% & 13\% & 12\% \\ \bottomrule
\end{tabular}
\end{table}

\paragraph*{Conclusion} In this experiment the dynamic gradient damage model is used to investigate the structural failure of a reinforced beam under severe impact. Similarly to \cref{sec:L-specimen}, it is illustrated that a more sophisticated damage constitutive law could be devised for the concrete material that introduces additional modeling parameters. Indeed, the internal length $\eta$ derived from the other material parameters in the \eqref{eq:at1} law may not be small by comparison with other structural length, which leads to a degenerated modeling of brittle fracture phenomena. By introducing additional modeling parameters such as in \cite{LorentzCuvilliezKazymyrenko:2011,AlessiMarigoVidoli:2015}, a relatively small internal length could be used. Theoretical and numerical investigation of these laws in dynamics could be performed in the future.

On the other hand, the discrepancy between the numerical result presented in particular in \cref{fig:beamsigm} and the experimental one reported in \cite{Guilbaud:2015} could also be attributed to the complex constitutive behaviors of concrete under compression. Under such loading conditions, strain softening is often accompanied by extensive plastic deformation, which is typical of a ductile material. In highly confined compression, stiffness degradation and inelastic expansion could also be significantly reduced. Future work could be devoted to a coupling between a plastic model that takes into account possible inelastic strains and the current gradient damage approach that accounts for brittle fracture in tension.

Another possible reason concerns strain-rate effects in the material constitutive modeling. From a macroscopic modeling point of view, a rate-dependent damage criterion could be used to account for a higher resistance of concrete for large strain rates, see \cite{Hentz:2003}. In the current variational formulation of the dynamic gradient damage model outlined in \cref{def:dynagraddama}, it is not taken into account. By introducing for example viscosity into the plasticity model, we would obtain a threshold for damage initiation that increases with the strain-rate. This rate-dependency need further investigation in the future for a better modeling of concrete behaviors.